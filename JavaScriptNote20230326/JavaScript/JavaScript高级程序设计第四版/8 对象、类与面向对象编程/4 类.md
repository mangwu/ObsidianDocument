# 4. ç±»

å‰é¢ä¸‰èŠ‚æ˜¯åœ¨JavaScriptè¿˜æ²¡æœ‰è§„èŒƒç±»ç‰¹æ€§æ—¶ï¼ˆECMAScript5åŠä¹‹å‰ï¼‰ï¼Œç”¨æ¥æ¨¡æ‹Ÿç±»ä¼¼ç±»ï¼ˆclass-likeï¼‰çš„è¡Œä¸º

å„ç§ç­–ç•¥éƒ½æœ‰è‡ªå·±çš„é—®é¢˜ï¼Œä¹Ÿæœ‰ç›¸äº’çš„å¦¥åï¼Œæœ€ç»ˆå®ç°ç»§æ‰¿çš„ä»£ç ï¼ˆå¯„ç”Ÿå¼ç»„åˆç»§æ‰¿æ¨¡å¼ï¼‰ä¹Ÿæ˜¾å¾—éå¸¸å†—é•¿å’Œæ··ä¹±

ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼ŒECMAScript 6 å¼•å…¥äº†æ–°çš„class å…³é”®å­—ï¼Œè®©JavaScriptå…·æœ‰æ­£å¼å®šä¹‰ç±»çš„èƒ½åŠ›

ç±»ï¼ˆclassï¼‰æ˜¯ECMAScriptä¸­æ–°çš„**åŸºç¡€æ€§è¯­æ³•ç³–**ç»“æ„ï¼Œå®ƒè®©JavaScriptè¡¨é¢ä¸Šçœ‹èµ·æ¥å¯ä»¥æ”¯æŒæ­£å¼çš„é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œå®é™…ä¸ŠèƒŒåä½¿ç”¨çš„**ä»ç„¶æ˜¯åŸå‹å’Œæ„é€ å‡½æ•°**çš„æ¦‚å¿µ

# 4.1 ç±»å®šä¹‰

## 4.1.0 MDNè¡¥å……-ç±»å®šä¹‰

- ç›´æ¥å®šä¹‰ï¼š**ç±»æ˜¯ç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¨¡æ¿ï¼ˆtemplateï¼‰**
- ç›´æ¥ä½œç”¨ï¼šç±»ç”¨ä»£ç **å°è£…**ï¼ˆ**encapsulate**ï¼‰æ•°æ®ä»¥æ–¹ä¾¿å¤„ç†æ•°æ®
- è™½ç„¶ç±»çš„å®ç°æ˜¯å»ºç«‹åœ¨åŸå‹ä¸Šçš„ï¼Œä½†æ˜¯ç±»ä¸ES5çš„**åƒç±»è¯­ä¹‰**ï¼ˆ**class-like semantics**ï¼‰æœ‰ä¸å…±äº«çš„çš„è¯­æ³•å’Œè¯­ä¹‰

## 4.1.1 å®šä¹‰ç±»çš„æ–¹å¼

- ä¸å‡½æ•°å®šä¹‰ç›¸ä¼¼ï¼Œå®šä¹‰ç±»æœ‰ä¸¤ç§ä¸»è¦æ–¹å¼ï¼šç±»å£°æ˜å’Œç±»è¡¨è¾¾å¼ï¼›è¿™ä¸¤ç§æ–¹å¼éƒ½ä½¿ç”¨`class`å…³é”®å­—å’ŒåŠ å¤§æ‹¬å·
- ç±»å£°æ˜
    
    ```jsx
    class Person {}
    ```
    
- ç±»è¡¨è¾¾å¼
    
    ```jsx
    const Animal = class {};
    ```
    
- ä¸å‡½æ•°è¡¨è¾¾å¼ç±»ä¼¼ï¼Œç±»è¡¨è¾¾å¼çš„ç±»åœ¨è¢«æ±‚å€¼å‰ä¸èƒ½è¢«å¼•ç”¨ï¼Œä½†ä¸å‡½æ•°å®šä¹‰ä¸åŒçš„æ˜¯ï¼Œå‡½æ•°å£°æ˜å¯ä»¥æå‡ï¼Œä½†æ˜¯ç±»å®šä¹‰ä¸èƒ½
    
    ```jsx
    // å‡½æ•°å£°æ˜å¯ä»¥æå‡ï¼Œç±»å£°æ˜ä¸èƒ½æå‡
    console.log(FunctionExpression); // undefined
    var FunctionExpression = function () {};
    console.log(FunctionExpression); // [Function: FunctionExpression]
    
    console.log(FunctionDeclaration); // [Function: FunctionDeclaration]
    function FunctionDeclaration() {}
    console.log(FunctionDeclaration); // [Function: FunctionDeclaration]
    
    console.log(ClassExpression); // undefined
    var ClassExpression = class {};
    console.log(ClassExpression); // [class ClassExpression]
    
    try {
      console.log(ClassDeclaration);
    } catch (error) {
      console.log(error.message); // Cannot access 'ClassDeclaration' before initialization
    }
    class ClassDeclaration {}
    console.log(ClassDeclaration); // [class ClassDeclaration]
    ```
    
    - `var` çš„å£°æ˜æå‡åªèƒ½ä½¿å¾—å‡½æ•°æˆ–ç±»å˜é‡å£°æ˜æå‡ï¼Œç›¸å½“äºå…ˆåœ¨ä½œç”¨åŸŸé¡¶éƒ¨å®šä¹‰ä¸€ä¸ª`undefined` å˜é‡
    - å‡½æ•°(`function`)çš„å£°æ˜æå‡èƒ½å°†æ•´ä¸ªå‡½æ•°åœ¨ä½œç”¨åŸŸé¡¶éƒ¨ç›´æ¥å£°æ˜å®šä¹‰
    - ç±»(`class`)å£°æ˜ä¸å­˜åœ¨å£°æ˜æå‡ï¼Œåªèƒ½åœ¨å£°æ˜ä¹‹åä½¿ç”¨ï¼Œå¦åˆ™æŠ¥`ReferenceError`é”™è¯¯
- ç±»å£°æ˜å’Œå‡½æ•°å£°æ˜çš„å¦ä¸€ä¸ªåŒºåˆ«åœ¨äºï¼Œå‡½æ•°å—å‡½æ•°ä½œç”¨åŸŸé™åˆ¶ï¼Œç±»å—å—ä½œç”¨åŸŸé™åˆ¶
    
    ```jsx
    // å‡½æ•°å£°æ˜å—å‡½æ•°ä½œç”¨åŸŸé™åˆ¶
    // ç±»å£°æ˜å—å—ä½œç”¨åŸŸé™åˆ¶
    {
      function FunctionDeclaration2() {}
      class ClassDeclaration2 {}
    }
    console.log(FunctionDeclaration2); // [Function: FunctionDeclaration2]
    try {
      console.log(ClassDeclaration2);
    } catch (error) {
      console.log(error.message); // ClassDeclaration2 is not defined
    }
    
    function declatation() {
      function FunctionDeclaration3() {}
      class ClassDeclaration3 {}
    }
    declatation();
    try {
      console.log(FunctionDeclaration3);
    } catch (error) {
      console.log(error.message); // FunctionDeclaration3 is not defined
    }
    try {
      console.log(ClassDeclaration3);
    } catch (error) {
      console.log(error.message); // ClassDeclaration3 is not defined
    }
    ```
    

## 4.1.2 ç±»çš„æ„æˆ

- ç±»å¯ä»¥åŒ…å«**æ„é€ å‡½æ•°æ–¹æ³•**ã€**å®ä¾‹æ–¹æ³•**ã€**è·å–å‡½æ•°(Getter)**ã€**è®¾ç½®å‡½æ•°(Setter)**å’Œ**é™æ€ç±»æ–¹æ³•**
    - è¿™äº›éƒ½ä¸æ˜¯å¿…é¡»çš„ï¼Œç©ºçš„ç±»å®šä¹‰ä¹Ÿæœ‰æ•ˆ
    - é»˜è®¤æƒ…å†µä¸‹ï¼Œç±»å®šä¹‰çš„ä»£ç éƒ½åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹æ‰§è¡Œ
- ä»¥ä¸‹æ˜¯ä¸€äº›åˆæ³•çš„ç±»å®šä¹‰ï¼Œå®ƒä»¬æˆ–ç©ºï¼Œæˆ–åŒ…å«æ„é€ å‡½æ•°ï¼Œæˆ–åŒ…å«è·å–å‡½æ•°ï¼Œæˆ–æœ‰é™æ€æ–¹æ³•ï¼›ç±»åé¦–å­—æ¯å¤§å†™ï¼Œä¸å®ƒåˆ›å»ºçš„å®ä¾‹åŒºåˆ†
    
    ```jsx
    // ç©ºç±»
    class Foo {}
    // åŒ…å«æ„é€ å‡½æ•°
    class Bar {
      constructor() {}
    }
    // åŒ…å«è·å–å‡½æ•°
    class Baz {
      get myBaz() {}
    }
    // åŒ…å«é™æ€æ–¹æ³•
    class Qux {
      static myQux() {}
    }
    ```
    
- æ‰“å°ç±»çš„`prototype`å±æ€§ï¼Œå‘ç°å®ƒä»¬çš„åŸå‹å¯¹è±¡å’Œä¸Šä¸€èŠ‚çš„æ„é€ å‡½æ•°ç»“æ„ä¸€è‡´ï¼ˆä»ä¾§é¢éªŒè¯ç±»èƒŒååŸç†è¿˜æ˜¯åŸå‹å’Œæ„é€ å‡½æ•°ï¼‰
    
    ```jsx
    console.log(Foo.prototype);
    console.log(Bar.prototype);
    console.log(Baz.prototype);
    console.log(Qux.prototype);
    console.log(typeof Foo); // 'function'
    ```
    
    ![Untitled](4%20%E7%B1%BB/Untitled.png)
    
    ![Untitled](4%20%E7%B1%BB/Untitled%201.png)
    
    - å®šä¹‰äº†è·å–å‡½æ•°çš„`Baz` åœ¨åŸå‹å¯¹è±¡ä¸­åŒ…å«`myBaz`å±æ€§å’Œ`myBaz getter`
    - å®šä¹‰äº†é™æ€å‡½æ•°çš„`Qux` åŸå‹å¯¹è±¡æ²¡æœ‰æ”¹å˜ï¼Œä½†æ˜¯ç±»æœ¬èº«æ‹¥æœ‰äº†å±æ€§æ–¹æ³•`myQux`
    - ä½¿ç”¨`typeof` åˆ¤æ–­å£°æ˜çš„ç±»ï¼Œå‘ç°è¿”å›çš„æ˜¯`function`, è¯´æ˜ç±»åº•å±‚å®ç°ä»ç„¶æ˜¯æ„é€ å‡½æ•°
    
    ![Untitled](4%20%E7%B1%BB/Untitled%202.png)
    
    ![Untitled](4%20%E7%B1%BB/Untitled%203.png)
    
- é€šè¿‡**ç±»è¡¨è¾¾å¼**å£°æ˜ç±»æ—¶ï¼Œå¯ä»¥**è‡ªå®šä¹‰åç§°**
    - æŠŠç±»èµ‹å€¼ç»™å˜é‡åï¼Œé€šè¿‡`name` å±æ€§å¯ä»¥è·å–ç±»è¡¨è¾¾å¼çš„åç§°å­—ç¬¦ä¸²
    - ä½†æ˜¯ä¸èƒ½åœ¨è¡¨è¾¾å¼ä½œç”¨åŸŸå¤–éƒ¨è®¿é—®è‡ªå®šä¹‰çš„åç§°æ ‡è¯†ç¬¦
    
    ```jsx
    // ç±»è¡¨è¾¾å¼ ç±»åç§°è‡ªå®šä¹‰
    let Person = class PersonName {
      identify() {
        console.log(Person.name, PersonName.name); 
      }
    };
    
    let p = new Person();
    p.identify(); // PersonName PersonName
    
    console.log(Person.name); // PersonName
    try {
      console.log(PersonName);
    } catch (error) {
      console.log(error.message); // PersonName is not defined
    }
    console.log(Object.getOwnPropertyDescriptor(Person, "name"));
    // {
      // value: 'PersonName',
      // writable: false,
      // enumerable: false,
      // configurable: true
    // }
    Object.defineProperty(Person, "name", {
      writable: true,
      configurable: true,
      value: "Person",
    });
    p.identify(); // Person Person
    ```
    
- ç”±ä¸Šè¿°ä¾‹å­å¯ä»¥å¾—çŸ¥`name` å±æ€§çš„ä¸€äº›ç‰¹æ€§
    - `name` å±æ€§çš„åˆå§‹å€¼åœ¨ç±»å£°æ˜ä¸­å°±æ˜¯**ç±»æ ‡è¯†ç¬¦çš„å­—ç¬¦ä¸²å½¢å¼**ï¼Œåœ¨ç±»è¡¨è¾¾å¼å®šä¹‰ä¸­ï¼Œå¦‚æœæ²¡æœ‰ç±»æ ‡è¯†ç¬¦ï¼Œå°±æ˜¯**å˜é‡æ ‡è¯†ç¬¦çš„å­—ç¬¦ä¸²å½¢å¼**ï¼Œå¦‚æœæœ‰ç±»æ ‡è¯†ç¬¦å°±æ˜¯ç±»æ ‡è¯†ç¬¦çš„å­—ç¬¦ä¸²å½¢å¼
    - `name` å±æ€§æ˜¯å¯é…ç½®ä¸å¯æšä¸¾ä¸å¯å†™çš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡`Object.defineProperty()` æ–¹æ³•åº”ç”¨äºç±»å¯¹è±¡ï¼Œå°†å…¶`name` å±æ€§ç‰¹æ€§è¿›è¡Œä¿®æ”¹ï¼Œä¸Šé¢ä¾‹å­ä¸­ä¿®æ”¹æˆäº†`"Person"` ,å®ä¾‹æ‰“å°çš„æ ‡è¯†ç¬¦ä¹Ÿå°±å˜äº†
    - åœ¨ä½¿ç”¨ç±»è¡¨è¾¾å¼å®šä¹‰ä¸­ï¼Œç±»çš„å†…éƒ¨å¯ä»¥ä½¿ç”¨æ ‡è¯†ç¬¦`PersonName` ï¼Œå› ä¸º`PersonName`åªå­˜åœ¨äºç±»å®šä¹‰ä¸­

æ³¨æ„ï¼Œå…³äºç±»è¡¨è¾¾å¼è‡ªå®šä¹‰åç§°ï¼Œã€ŠJavaScripté«˜çº§ç¨‹åºè®¾è®¡ç¬¬4ç‰ˆã€‹è¿™é‡Œçš„ä¾‹å­å…¶å®å¾ˆç»å…¸ï¼Œä½†æ˜¯ä¸å¥½ç†è§£ï¼Œå› ä¸ºæ²¡æœ‰ç»™å‡º**ä¸ºä»€ä¹ˆ**ç±»è¡¨è¾¾å¼çš„è‡ªå®šä¹‰åç§°çš„æ ‡è¯†ç¬¦**åªèƒ½ç”¨äºç±»å†…éƒ¨**ï¼Œè€Œå¤–éƒ¨**ä¸èƒ½ä½¿ç”¨**è‡ªå®šä¹‰åç§°çš„æ ‡è¯†ç¬¦ï¼Œåœ¨ã€Šæ·±å…¥ç†è§£ES6ã€‹ä¸­å…³äºç±»çš„å£°æ˜æ–¹å¼æ›´åŠ è¯¦ç»†ï¼Œä¸‹é¢çš„æ–‡ç« å‚è€ƒ[ç½‘ç»œ](http://wjhsh.net/Ryukaka-p-7885802.html)

[ã€æ·±å…¥ç†è§£ES6ã€‘JavaScriptä¸­çš„ç±»](4%20%E7%B1%BB/%E3%80%90%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3ES6%E3%80%91JavaScript%E4%B8%AD%E7%9A%84%E7%B1%BB.md)

## 4.1.3 MDNçš„è¡¥å……-ç±»æ„æˆ

### 4.1.3.1 ç±»ä¸»ä½“

- **class body ï¼Œ**ç±»ä¸»ä½“æŒ‡classå…³é”®å­—åï¼ŒèŠ±æ‹¬å·ï¼ˆcurly bracketsï¼‰`{}`åŒ…è£¹çš„éƒ¨åˆ†
- è¿™ç±»ä¸»ä½“ä¸­å®šä¹‰çš„ä»»ä½•ä¸œè¥¿éƒ½ç§°ä¸º**ç±»æˆå‘˜**(**class members**),ç±»æˆå‘˜å°±åŒ…æ‹¬ä¸Šé¢[4.1.2 ç±»çš„æ„æˆ](4%20%E7%B1%BB.md) æåˆ°çš„constructorã€methodsç­‰
- **ç±»ä¸»ä½“ä¸­çš„ä»£ç ä»¥ä¸¥æ ¼æ¨¡å¼æ‰§è¡Œ**ï¼Œå³
    - classå…³é”®å­—åï¼ŒèŠ±æ‹¬å·åŒ…è£¹çš„éƒ¨åˆ†ä»£ç æœä»æ›´ä¸¥æ ¼çš„è¯­æ³•ï¼Œè¿™èƒ½æé«˜æ€§èƒ½
    - ä¸€äº›åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ä¸å…è®¸çš„è¯­æ³•ä¼šæŠ›å‡º**é™é»˜é”™è¯¯ï¼ˆsilent errorï¼‰**
    - ä¸€äº›å…³é”®å­—ä¸ºECMAScriptçš„æœªæ¥ç‰ˆæœ¬ä¿ç•™ï¼ˆreserveï¼‰ï¼Œå¦‚`private` å…³é”®å­—ï¼Œè¡¨ç¤ºç±»æˆå‘˜ç§æœ‰ï¼Œåœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹å¯ä»¥ä½œä¸ºå˜é‡åç§°ï¼Œä½†æ˜¯ä¸¥æ ¼æ¨¡å¼ä¸‹ä¸è¡Œ

### 4.1.3.2 ç±»æ„é€ å‡½æ•°ï¼ˆconstructor methodï¼‰

- ç›´æ¥å®šä¹‰ï¼šæ„é€ å‡½æ•°(constructor method)æ˜¯ç”¨äº**åˆ›å»º**å¹¶**åˆå§‹åŒ–**å¯¹è±¡çš„ç‰¹æ®Šæ–¹æ³•
- ç‰¹æ®Šæ€§ï¼šä¸€ä¸ªç±»ä¸­åªèƒ½æœ‰ä¸€ä¸ªåä¸º`constructor`çš„æ„é€ æ–¹æ³•ï¼Œå¦‚æœæœ‰å¤šä¸ªä¼šæŠ›å‡ºè¯­æ³•é”™è¯¯ï¼ˆSyntax Errorï¼‰

# 4.2 ç±»æ„é€ å‡½æ•°

**`constructor`å…³é”®å­—ç”¨äºåœ¨ç±»å®šä¹‰å—å†…éƒ¨åˆ›å»ºç±»çš„æ„é€ å‡½æ•°**ã€‚

æ–¹æ³•å`constructor`ä¼šå‘Šè¯‰è§£é‡Šå™¨åœ¨ä½¿ç”¨`new` æ“ä½œç¬¦åˆ›å»ºç±»çš„æ–°å®ä¾‹æ—¶ï¼Œåº”è¯¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚

æ„é€ å‡½æ•°[ä¸æ˜¯å¿…é¡»](4%20%E7%B1%BB.md)çš„ï¼Œä¸å®šä¹‰æ„é€ å‡½æ•°ç›¸å½“äºå°†æ„é€ å‡½æ•°å®šä¹‰ä¸ºç©ºå‡½æ•°

## 4.2.1 å®ä¾‹åŒ–

- ä½¿ç”¨`new` æ“ä½œç¬¦å®ä¾‹åŒ–ç±»çš„æ“ä½œç­‰ä»·äºä½¿ç”¨`new` è°ƒç”¨ç±»çš„æ„é€ å‡½æ•°
- JavaScriptè§£é‡Šå™¨çŸ¥é“ä½¿ç”¨`new` å’Œç±»æ„å‘³ç€åº”è¯¥ä½¿ç”¨`constructor`å‡½æ•°è¿›è¡Œå®ä¾‹åŒ–
- ä½¿ç”¨`new` è°ƒç”¨ç±»çš„æ„é€ å‡½æ•°ä¼šæ‰§è¡Œå¦‚ä¸‹æ“ä½œ
    1. åœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡
    2. è¿™ä¸ªæ–°å¯¹è±¡å†…éƒ¨çš„[[Prototype]]æŒ‡é’ˆè¢«èµ‹å€¼ä¸ºæ„é€ å‡½æ•°çš„`prototype`å±æ€§
    3. æ„é€ å‡½æ•°å†…éƒ¨çš„`this` è¢«èµ‹å€¼ä¸ºè¿™ä¸ªæ–°å¯¹è±¡ï¼ˆå³`this`æŒ‡å‘æ–°å¯¹è±¡ï¼‰
    4. æŒ‡å‘æ„é€ å‡½æ•°å†…éƒ¨çš„ä»£ç ï¼ˆç»™æ–°å¯¹è±¡æ·»åŠ å±æ€§ï¼‰
    5. å¦‚æœæ„é€ å‡½æ•°è¿”å›éç©ºå¯¹è±¡ï¼Œåˆ™è¿”å›è¯¥å¯¹è±¡ï¼›å¦åˆ™è¿”å›åˆšåˆ›å»ºçš„æ–°å¯¹è±¡
- ä»¥ä¸Šå®ä¾‹åŒ–çš„è¿‡ç¨‹å’Œæ„é€ å‡½æ•°æ¨¡å¼åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹**[å®Œå…¨ä¸€æ ·](2%20%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1.md)**
    - åªæ˜¯ä¸€ä¸ªæ˜¯ä½¿ç”¨new æ“ä½œç¬¦è°ƒç”¨å¤–éƒ¨å£°æ˜çš„æ„é€ å‡½æ•°
    - ä¸€ä¸ªæ˜¯ä½¿ç”¨`new`æ“ä½œç¬¦ è°ƒç”¨ç±»å†…éƒ¨çš„æ„é€ å‡½æ•°
- ç±»æ„é€ å‡½æ•°å’Œæ„é€ å‡½æ•°çš„ä¸»è¦åŒºåˆ«åœ¨äº
    - è°ƒç”¨ç±»æ„é€ å‡½æ•°å¿…é¡»ä½¿ç”¨`new` æ“ä½œç¬¦åŠ ç±»ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨`new`ï¼Œä¼š[æŠ›å‡ºé”™è¯¯](4%20%E7%B1%BB/%E3%80%90%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3ES6%E3%80%91JavaScript%E4%B8%AD%E7%9A%84%E7%B1%BB.md)
    - è°ƒç”¨æ™®é€šæ„é€ å‡½æ•°å¯ä»¥ä¸ä½¿ç”¨`new` è°ƒç”¨ï¼Œè€Œæ˜¯ä»¥å…¨å±€çš„`this`ä½œä¸ºå†…éƒ¨å¯¹è±¡
    - ç±»æ„é€ å‡½æ•°æ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šä¹‹å¤„ï¼Œå®ä¾‹åŒ–åï¼Œå®ƒä¼šæˆä¸ºæ™®é€šçš„å®ä¾‹æ–¹æ³•ï¼Œä½†ä»ç„¶éœ€è¦ä½¿ç”¨`new` æ‰èƒ½è°ƒç”¨
- ä½¿ç”¨ç±»æ„é€ å‡½æ•°æ—¶ï¼Œå¦‚æœä¸éœ€è¦å‚æ•°ï¼Œç±»ååçš„æ‹¬å·**ä¹Ÿ**æ˜¯å¯é€‰çš„
- ä¾‹å­ï¼šç®€å•ä¾‹å­ï¼Œå®ä¾‹åŒ–å°±æ˜¯è°ƒç”¨ç±»æ„é€ å‡½æ•°ï¼Œç±»åªæ˜¯è¯­æ³•ç³–ï¼Œå…¶æ‰€åšçš„äº”æ­¥å’Œæ„é€ å‡½æ•°**æ²¡æœ‰åŒºåˆ«**
    
    ```jsx
    class Person {
      constructor(age, name) {
        this.age = age;
        this.name = name;
      }
    }
    
    const person = new Person(22, "mangwu"); 
    console.log(person.__proto__ === Person.prototype); // true
    console.log(person.constructor === Person.prototype.constructor); // true
    console.log(person.constructor); // [class Person]
    ```
    
    åº•å±‚åŸå‹é“¾å¯è§†åŒ–ï¼Œå’Œæ„é€ å‡½æ•°æ²¡æœ‰åŒºåˆ«ï¼Œå”¯ä¸€åŒºåˆ«åœ¨äºæ„é€ å‡½æ•°è¢«æ¢åšäº†æ‰€è°“çš„**ç±»**ï¼Œ`constructor`å±æ€§æŒ‡å‘è¿™ä¸ªç±»
    
    ![ç±».png](4%20%E7%B1%BB/%25E7%25B1%25BB.png)
    
    - `name` å’Œ`length` æ˜¯ç±»çš„è‡ªæœ‰å±æ€§ï¼Œæ„é€ å‡½æ•°åŒæ ·æ‹¥æœ‰è¿™ä¸¤ä¸ªå±æ€§
    - é™¤æ­¤ä¹‹å¤–ï¼Œæ„é€ å‡½æ•°æœ¬èº«è¿˜å…·æœ‰`arguments`å’Œ`caller` å±æ€§ï¼Œå› ä¸ºç±»çš„åº•å±‚å®ç°ä½¿ç”¨ä¸¥æ ¼æ¨¡å¼ï¼Œæ‰€ä»¥ä¸èƒ½è®¿é—®è¿™ä¸¤ä¸ªå±æ€§ï¼Œæˆ–è€…æŠ›å‡ºå¼‚å¸¸ï¼Œå¦‚ä¸‹
        
        ![Untitled](4%20%E7%B1%BB/Untitled%204.png)
        
- ä¾‹å­ï¼šç±»å®ä¾‹åŒ–å¯ä»¥ä¸ä¼ å…¥å‚æ•°ï¼Œä¸ä¼ å…¥å‚æ•°å°±å¯ä»¥çœç•¥ç±»ååçš„æ‹¬å·
    
    ```jsx
    class Person {
      constructor(age, name) {
        console.log(arguments.length);
        this.age = age;
        this.name = name;
      }
    }
    let p0 = new Person; // 0
    console.log(p0.name); // undefined
    let p1 = new Person(); // 0
    console.log(p1.name); // undefined
    let p2 = new Person(22); // 1
    console.log(p2.name); // undefined
    let p3 = new Person(22, "mangwu"); // 2
    console.log(p3.name); // mangwu
    ```
    
- ä¾‹å­ï¼šåœ¨`new` ç±»æ„é€ å‡½æ•°çš„[ç¬¬äº”æ­¥](4%20%E7%B1%BB.md)ï¼Œå¦‚æœ**ç±»æ„é€ å‡½æ•°æœ‰è¿”å›å€¼**ï¼Œè¿™ä¸ªè¿”å›å€¼ä¸ä¼šå’Œç±»æœ‰ä»»ä½•å…³è”ï¼Œå› ä¸ºè¿”å›å€¼çš„åŸå‹æŒ‡é’ˆå¹¶æ²¡æœ‰è¢«ä¿®æ”¹ä¸ºç±»çš„åŸå‹
    
    ```jsx
    class Person {
      constructor(name, override) {
        this.name = name;
        if (override) {
          return {
            name,
          };
        }
      }
    }
    const p1 = new Person("mangwu");
    const p2 = new Person("mangwu", true);
    console.log(p1); // Person { name: 'mangwu' }
    console.log(p1 instanceof Person); // true
    console.log(p2); // { name: 'mangwu' }
    console.log(p2 instanceof Person); // false
    ```
    
- ä¾‹å­ï¼šè°ƒç”¨ç±»çš„æ„é€ å¿…é¡»ä½¿ç”¨`new` ï¼Œå¦åˆ™æŠ¥é”™ï¼Œå¯¹äºä¿å­˜åœ¨å®ä¾‹ä¸­çš„`constructor` å±æ€§åŒæ ·å¦‚æ­¤
    
    ```jsx
    class Person {
      constructor(name) {
        this.name = name;
      }
    }
    
    try {
      const p1 = Person("mangwu");
    } catch (error) {
      console.log(error.toString()); // TypeError: Class constructor Person cannot be invoked without 'new'
    }
    
    const p2 = new Person("mangwu");
    try {
      const p3 = p2.constructor("wumang");
    } catch (error) {
      console.log(error.toString()); // TypeError: Class constructor Person cannot be invoked without 'new'
    }
    
    const p4 = new p2.constructor("wumang");
    
    console.log(p2); // Person { name: 'mangwu' }
    console.log(p4); // Person { name: 'wumang' }
    ```
    
    - ä¸ºä½•ä¸€å®šè¦ä½¿ç”¨`new` æ˜¯ECMAScript6 ç±»ç‰¹æ€§è§„èŒƒçš„ï¼Œå®ƒé€šè¿‡`new.target` çš„å€¼åˆ¤æ–­ä½¿ç”¨äº†`new` ï¼Œå…·ä½“å®ç°æŸ¥çœ‹[ä½¿ç”¨å‡ºäº†ç±»ä¹‹å¤–çš„è¯­æ³•(é—­åŒ…åŠ æ„é€ å‡½æ•°)ä¸ºPersonClassç¼–å†™ç­‰ä»·ä»£ç ](4%20%E7%B1%BB/%E3%80%90%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3ES6%E3%80%91JavaScript%E4%B8%AD%E7%9A%84%E7%B1%BB.md)

## 4.2.2 æŠŠç±»å½“æˆç‰¹æ®Šå‡½æ•°

- ECMAScriptä¸­çš„ç±»å’Œå…¶ä»–è¯­è¨€ä¸å¤ªåŒï¼ŒECMAScriptä¸­æ²¡æœ‰æ­£å¼çš„ç±»è¿™ä¸ªç±»å‹ï¼Œå®ƒåªæ˜¯åœ¨æ„é€ å‡½æ•°å’ŒåŸå‹é“¾çš„ç»§æ‰¿ä¸Šæå‡ºçš„å¿«é€Ÿåˆ›å»ºå¯¹è±¡çš„è¯­æ³•ç³–
- ä»å„æ–¹é¢çœ‹ï¼Œ**ECMAScript ç±»å°±æ˜¯ä¸€ç§ç‰¹æ®Šå‡½æ•°**ï¼Œä¸€ç§ä¸èƒ½ç›´æ¥è°ƒç”¨åªèƒ½é€šè¿‡`new` æ“ä½œç¬¦è°ƒç”¨çš„äº§ç”Ÿç±»å®ä¾‹çš„ç‰¹æ€§å‡½æ•°
- å’Œæ™®é€šæ„é€ å‡½æ•°ç›¸åŒçš„åœ°æ–¹
    1. ç±»æ ‡è¯†ç¬¦æœ‰`prototype`å±æ€§ï¼Œå’Œæ¯ä¸ªå‡½æ•°å£°æ˜åå°±æœ‰çš„`prototype` ç›¸åŒï¼Œä¸”è¿™ä¸ªåŸå‹ä¹Ÿæœ‰ä¸€ä¸ª`constructor`å±æ€§æŒ‡å‘ç±»è‡ªèº«
    2. ä¸æ™®é€šæ„é€ å‡½æ•°ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨`instanceof`æ“ä½œç¬¦æ£€æŸ¥æ„é€ å‡½æ•°åŸå‹æ˜¯å¦å­˜åœ¨äºå®ä¾‹çš„åŸå‹é“¾ä¸­
    3. ç±»æœ¬èº«å…·æœ‰å’Œæ™®é€šæ„é€ å‡½æ•°ä¸€æ ·çš„è¡Œä¸ºï¼Œç±»ä¸Šä¸‹æ–‡ä¸­ï¼Œç±»æœ¬èº«ä½¿ç”¨`new`è°ƒç”¨æ—¶å°±ä¼šè¢«å½“æˆæ„é€ å‡½æ•°
    4. ç±»ä¸å…¶ä»–å‡½æ•°ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨ç±»è¡¨è¾¾å¼å£°æ˜åç«‹å³è°ƒç”¨(å¿…é¡»ä½¿ç”¨`new`è°ƒç”¨)
- ä¾‹å­
    
    ```jsx
    // ç±»ä¸æ„é€ å‡½æ•°ç›¸åŒçš„åœ°æ–¹
    // 1. ç±»ä¹Ÿå…·æœ‰prototypeå±æ€§ï¼Œå¹¶ä¸”è¿™ä¸ªåŸå‹ä¹Ÿæœ‰ä¸€ä¸ªconstructoræŒ‡å‘è‡ªèº«
    class Person {}
    console.log(Person.prototype); // {} åŸå‹çš„å±æ€§æ˜¯ä¸å¯æšä¸¾çš„
    console.log(Person === Person.prototype.constructor); // true
    
    // 2. ä¸æ™®é€šæ„é€ å‡½æ•°ä¸€æ ·å¯ä»¥ä½¿ç”¨instanceof æ£€æŸ¥æ„é€ å‡½æ•°çš„åŸå‹æ˜¯å¦å­˜åœ¨äºå®ä¾‹åŸå‹é“¾ä¸­
    let p = new Person();
    console.log(p instanceof Person); // true
    
    // 3. ç±»æœ¬èº«ä¸æ™®é€šæ„é€ å‡½æ•°å…·æœ‰ä¸€æ ·çš„è¡Œä¸ºï¼Œä½¿ç”¨newè°ƒç”¨ç±»æ—¶ç±»å°±ä¼šè¢«å½“ä½œæ„é€ å‡½æ•°
    console.log(p.constructor === Person); // true
    console.log(p.__proto__ === Person.prototype); // true
    console.log(p.__proto__.constructor === Person.prototype.constructor); // true
    
    // 4. ç±»åœ¨å’Œå…¶ä»–å‡½æ•°ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨ç±»è¡¨è¾¾å¼å£°æ˜åç«‹å³è°ƒç”¨
    let foo = new (class Bar {
      constructor(str) {
        console.log(str);
        this.str = str;
      }
    })("bar"); // bar
    console.log(foo); // Bar { str: 'bar' }
    ```
    
- **æ³¨æ„**
    - ç±»ä¸­å®šä¹‰çš„`constructor`å’Œç±»åŸå‹ä¸­çš„å±æ€§`constructor` ä¸æ˜¯åŒä¸€ç§ä¸œè¥¿
        - å‰è€…æ˜¯ç±»ä½œä¸ºç‰¹æ®Šå‡½æ•°è¢«è°ƒç”¨æ—¶éœ€è¦æ‰§è¡Œçš„æ„é€ å‡½æ•°ï¼Œå®ƒè¢«å®šä¹‰åœ¨ç±»çš„[[Prototype]]ç‰¹æ€§ä¸­ï¼Œå®ƒæœ‰è‡ªå·±çš„åŸå‹å¯¹è±¡
        - è€Œåè€…æ˜¯ç±»åŸå‹ä¸Šçš„å±æ€§ï¼Œå±æ€§å€¼ä¸ºç±»æœ¬èº«
    - ä½¿ç”¨ç±»å£°æ˜çš„å®ä¾‹çš„[[Prototype]]ç‰¹æ€§æŒ‡å‘çš„æ˜¯ç±»çš„åŸå‹ï¼Œå³`ClassName.prototype`
    - ä½¿ç”¨ç±»ä¸­å®šä¹‰`constructor` å£°æ˜çš„å®ä¾‹æŒ‡å‘çš„æ˜¯æ„é€ å‡½æ•°æœ¬èº«çš„åŸå‹ï¼Œå³`ClassName.__proto__.constructor.prototype`
    - `constructor` ä½œä¸ºç±»ä¸­å”¯ä¸€çš„[ä¿ç•™æ–¹æ³•åç§°](4%20%E7%B1%BB/%E3%80%90%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3ES6%E3%80%91JavaScript%E4%B8%AD%E7%9A%84%E7%B1%BB.md) ï¼Œå®ƒæ˜¯ä½œä¸ºç±»å¯¹è±¡æœ¬èº«çš„[[Prototype]]ç‰¹æ€§ä¸­çš„æ–¹æ³•ï¼ˆç±»å¯¹è±¡çš„åŸå‹æ–¹æ³•ï¼‰ï¼Œè€Œä¸æ˜¯åƒå…¶ä»–æ–¹æ³•ä¸€æ ·å®šä¹‰åœ¨`ClassName.prototype` å±æ€§ä¸Šï¼ˆå®ä¾‹å¯¹è±¡çš„åŸå‹æ–¹æ³•ï¼‰
        
        ```jsx
        // ä¸€ä¸ªæ˜¯å®šä¹‰åœ¨ç±»ä¸­çš„æ„é€ å‡½æ•°constructor
        // ä¸€ä¸ªæ˜¯å®šä¹‰åœ¨ç±»çš„prototypeå±æ€§ä¸­çš„constructorå±æ€§ï¼ŒæŒ‡å‘ç±»æœ¬èº«
        class Person {}
        
        let p1 = new Person();
        console.log(p1.constructor === Person); // true
        console.log(p1 instanceof Person); // true
        console.log(p1 instanceof Person.constructor); // false
        
        let p2 = new Person.constructor();
        console.log(p2.constructor === Person); // false
        console.log(p2 instanceof Person); // false
        console.log(p2 instanceof Person.constructor); // true
        
        console.log(p2.constructor === Person.constructor); // true
        console.log(p2.__proto__ === Person.__proto__.constructor.prototype); // true
        ```
        
        - `p2` æ˜¯ç±»ä¸­çš„æ„é€ å‡½æ•°æœ¬èº«åˆ›å»ºçš„å®ä¾‹ï¼Œå®ƒçš„åŸå‹è¢«èµ‹å€¼ä¸ºå‡½æ•°æœ¬èº«çš„`prototype` å±æ€§ï¼Œå³`Person.__proto__.constructor.prototype`
    - ä¸Šé¢ä¾‹å­çš„å¯è§†åŒ–å¦‚ä¸‹
        
        ![ç±»æ„é€ å‡½æ•°.png](4%20%E7%B1%BB/%25E7%25B1%25BB%25E6%259E%2584%25E9%2580%25A0%25E5%2587%25BD%25E6%2595%25B0.png)
        
- **ç±»æ˜¯JavaScriptçš„ä¸€ç­‰å…¬æ°‘ï¼Œ**å› æ­¤å¯ä»¥åƒå…¶ä»–å¯¹è±¡æˆ–å‡½æ•°å¼•ç”¨ä¸€æ ·æŠŠç±»ä½œä¸ºå‚æ•°ä¼ é€’ï¼š**ç±»æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå‡½æ•°å¯¹è±¡**
    
    ```jsx
    // ç±»æ˜¯JavaScriptçš„ä¸€ç­‰å…¬æ°‘ï¼Œå¯ä»¥åƒå¯¹å¾…å…¶ä»–å¯¹è±¡æˆ–å‡½æ•°å¼•ç”¨ä¸€æ ·æŠŠç±»ä½œä¸ºå‚æ•°ä¼ é€’
    let classList = [
      class {
        constructor(id) {
          this.id_ = id;
          console.log(`instance ${this.id_}`);
        }
      },
    ];
    function createInstance(classDefinition, id) {
      return new classDefinition(id);
    }
    let foo = createInstance(classList[0], 2415); // instance 2415
    ```
    
    - æŠŠç±»å½“ä½œä¸€ä¸ªå¯¹è±¡å¯¹å¾…ï¼Œå¯ä»¥ä¿å­˜åœ¨æ•°ç»„ä¸­ï¼Œå¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°

# 4.3 å®ä¾‹ã€åŸå‹å’Œç±»æˆå‘˜

ç±»çš„è¯­æ³•æ–¹ä¾¿å®šä¹‰å­˜åœ¨äºå®ä¾‹ä¸Šçš„æˆå‘˜ï¼ˆå¯¹è±¡è‡ªæœ‰å±æ€§ï¼‰ã€åº”è¯¥å­˜åœ¨äºåŸå‹ä¸Šçš„æˆå‘˜ï¼ˆå¯¹è±¡åŸå‹å±æ€§ï¼‰ã€ä»¥åŠåº”è¯¥å­˜åœ¨äºç±»æœ¬èº«çš„æˆå‘˜ï¼ˆç±»è‡ªæœ‰å±æ€§ï¼‰

## 4.3.1 å®ä¾‹æˆå‘˜

- æ¯æ¬¡é€šè¿‡ `new` æ“ä½œç¬¦è°ƒç”¨ç±»æ ‡è¯†ç¬¦ï¼Œéƒ½ä¼šæ‰§è¡Œç±»æ„é€ å‡½æ•°`constructor`
- `constructor` å‡½æ•°ä¼šä¸ºæ–°åˆ›å»ºçš„å®ä¾‹(`this`)æ·»åŠ **è‡ªæœ‰**ï¼ˆ**own**ï¼‰å±æ€§
- è‡³äºæ·»åŠ ä»€ä¹ˆæ ·çš„å±æ€§ï¼Œå±æ€§å€¼çš„ç±»å‹æ²¡æœ‰ä»»ä½•é™åˆ¶
- åœ¨`constructor` å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œä»ç„¶å¯ä»¥ç»™å®ä¾‹ç»§ç»­æ·»åŠ æ–°æˆå‘˜
- ä¾‹å­
    
    ```jsx
    // å®ä¾‹æˆå‘˜ï¼Œå³å®ä¾‹å¯¹è±¡çš„è‡ªæœ‰å±æ€§æˆ–æ–¹æ³•
    class Person {
      constructor() {
        // ä½¿ç”¨åŒ…è£…å¯¹è±¡æ˜¯ä¸ºäº†è¯´æ˜å®ä¾‹æˆå‘˜ä¸ä¼šå…±äº«å±äºå¯¹è±¡çš„è‡ªæœ‰å±æ€§æˆ–æ–¹æ³•
        this.name = new String("mangwu");
        this.sayName = () => console.log(this.name);
        this.nicknames = ["mang", "mango"];
      }
    }
    let p1 = new Person();
    let p2 = new Person();
    console.log(p1.name === p2.name); // false
    console.log(p1.sayName === p2.sayName); // false
    console.log(p1.nicknames === p2.nicknames); // false
    ```
    
    - åœ¨ç±»æ„é€ å‡½æ•°ä¸­ä¸º`this` æ·»åŠ çš„å±æ€§å°±æ˜¯å®ä¾‹æˆå‘˜ï¼Œå› ä¸ºå®ƒä»¬ä¸åœ¨`Person.prototype` ä¸Šï¼Œæ‰€ä»¥ä¸ä¼šå…±äº«

## 4.3.2 åŸå‹æ–¹æ³•å’Œè®¿é—®å™¨

### 4.3.2.1 åŸå‹æ–¹æ³•

- ä¸Šé¢ä¸€å°èŠ‚çš„ä¾‹å­ä¸­ï¼Œ`this.sayName()` æ–¹æ³•å…·æœ‰ç›¸åŒçš„é€»è¾‘ï¼Œ`this` åœ¨å®ä¾‹è°ƒç”¨æ—¶ä¼šè‡ªåŠ¨è¯†åˆ«ï¼Œæ‰€ä»¥å¯ä»¥å®šä¹‰åˆ°åŸå‹é“¾ä¸Šä½œä¸ºå…±äº«æ–¹æ³•ä½¿ç”¨ï¼Œæ–¹ä¾¿å¤ç”¨æ–¹æ³•
- ä¸ºäº†åœ¨å®ä¾‹ä¹‹é—´å…±äº«æ–¹æ³•ï¼Œ**ç±»å®šä¹‰è¯­æ³•**æŠŠåœ¨**ç±»å—ä¸­**å®šä¹‰çš„æ–¹æ³•ä½œä¸ºåŸå‹æ–¹æ³•ï¼Œè¯­æ³•å¦‚ä¸‹
    
    ```jsx
    class ClassName {
    	constructor() {
    		// ç±»ä¿ç•™æ–¹æ³•ï¼Œå®šä¹‰åœ¨ç±»çš„__proto__ç‰¹æ€§ä¸Š
    	}
    	method1() {
    		// ç±»åŸå‹æ–¹æ³•ï¼Œå®šä¹‰åœ¨ç±»çš„prototypeå±æ€§ä¸Š
    	}
    	method2() {
    		// å¯ä»¥å®šä¹‰å¤šä¸ªä¸é‡åçš„ç±»åŸå‹æ–¹æ³•
    	}
    	...
    	methodn() {
    		// å¦‚æœè¯¥ç±»ç»§æ‰¿äº†å…¶ä»–ç±»ï¼Œé‚£ä¹ˆå®šä¹‰çš„åŸå‹æ–¹æ³•å¯ä»¥ä¸çˆ¶ç±»çš„æ–¹æ³•é‡åä»¥**é®è”½çˆ¶ç±»æ–¹æ³•**
    	}
    }
    ```
    
    - `methodi` æ˜¯ç±»æ–¹æ³•åç§°ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²ï¼ˆstringï¼‰ï¼Œç¬¦å·ï¼ˆSymbolï¼‰æˆ–è®¡ç®—çš„å€¼ï¼ˆexpressionï¼‰ä½œä¸ºé”®
- ä¾‹å­
    
    ```jsx
    class Person {
      // constructor æ˜¯ç±»å”¯ä¸€ä¿ç•™çš„å®šä¹‰åœ¨__proto__ä¸Šçš„æ–¹æ³•
      // ç”¨äºåˆ›å»ºå®ä¾‹æˆå‘˜
      constructor(friends = []) {
        // æ·»åŠ åˆ°thisçš„æ‰€æœ‰å†…å®¹éƒ½ä¼šå­˜åœ¨äºä¸åŒå®ä¾‹ä¸Š
        this.locate = () => console.log("instance");
        this.friends = friends;
      }
      locate() {
        console.log("prototype");
      }
      *[Symbol.iterator]() {
        yield* this.friends;
      }
      [22]() {
        console.log(22);
      }
    }
    const p = new Person(["mangwu", "mangwu", "wugo"]);
    p.locate(); // instance
    Person.prototype.locate(); // prototype
    
    for (const friend of p) {
      console.log(friend); // mangwu mangwu wugo
    }
    p[22](); // 22
    ```
    
    - å¯¹æ¯”äº†`this.locate()` å’Œ`Person.prototype.locate()` æ–¹æ³•ï¼Œä¸€ä¸ªå±äºç±»å®ä¾‹æˆå‘˜ï¼Œä¸€ä¸ªå±äºç±»åŸå‹æ–¹æ³•
    - å®šä¹‰æ„é€ å™¨å·¥å‚å‡½æ•°ï¼ˆ`Symbol.iterator`ï¼‰ä½¿å¾—ç±»å®ä¾‹å¯è·Œæ‰“
    - å®šä¹‰ä»¥æ•°å­—ä¸ºåç§°çš„å‡½æ•°ï¼Œè°ƒç”¨æ—¶éœ€è¦ä½¿ç”¨ä¸­æ‹¬å·
- æ³¨æ„ï¼ŒJavaScripté«˜çº§ç¨‹åºè®¾è®¡ï¼ˆç¬¬4ç‰ˆï¼‰ä¸­æœ‰å¦‚ä¸‹è¯´æ³•
    
    > å¯ä»¥æŠŠæ–¹æ³•å®šä¹‰åœ¨ç±»æ„é€ å‡½æ•°ä¸­æˆ–ç±»å—ä¸­ï¼Œä½†æ˜¯ä¸èƒ½åœ¨ç±»å—ä¸­ç»™åŸå‹æ·»åŠ åŸå§‹å€¼æˆ–å¯¹è±¡ä½œä¸ºæˆå‘˜æ•°æ®
    > 
    
    è¦ç†è§£è¿™å¥è¯çš„å«ä¹‰åº”è¯¥ä»å‡ ä¸ªæ–¹é¢å…¥æ‰‹ï¼š
    
    1. ç›´æ¥åœ¨ç±»å—ä¸­è€Œä¸æ˜¯åœ¨æ„é€ å‡½æ•°ç¡®å®æ— æ³•ç»™ç±»**åŸå‹**æ·»åŠ åŸå§‹å€¼æˆ–å¯¹è±¡ä½œä¸ºæˆå‘˜æ•°æ®
        
        ```jsx
        class Person {
        	name: 'Jake'
        }
        // æŠ¥è¯­æ³•é”™è¯¯ SyntaxError: Unexpected identifier
        ```
        
        - è¿™å±äºè¯­æ³•é”™è¯¯ï¼Œæ•´ä¸ªä»£ç å°±æ— æ³•è¿è¡Œ
    2. ä½†æ˜¯ç›´æ¥åœ¨ç±»å—ä¸­ä½¿ç”¨èµ‹å€¼è¯­å¥æ˜¯å¯ä»¥ç»™**å®ä¾‹**æ·»åŠ åŸå§‹å€¼æˆ–å¯¹è±¡ä½œä¸ºæˆå‘˜æ•°æ®çš„
        
        ```jsx
        class Test {
          **name = 2;**
        }
        const test = new Test();
        console.log(test); // Test { name: 2 }
        console.log(Object.getOwnPropertyDescriptors(test)); 
        // {
          // name: { value: 2, writable: true, enumerable: true, configurable: true }
        // }
        ```
        
        - `name` æ˜¯å®šä¹‰åœ¨æ–°å®ä¾‹ä¸Šçš„è‡ªæœ‰å±æ€§ï¼Œå®ƒå¯é…ç½®å¯æšä¸¾å¯å†™
    3. è™½ç„¶ä¸èƒ½ç›´æ¥åœ¨ç±»å—ä¸­ç»™ç±»åŸå‹æ·»åŠ åŸå§‹å€¼æˆ–å¯¹è±¡ä½œä¸ºæˆå‘˜ï¼Œä½†æ˜¯å¯ä»¥åœ¨æ„é€ å‡½æ•°ä¸­ç›´æ¥é€šè¿‡ç±»åŸå‹è¿›è¡Œæ·»åŠ 
        
        ```jsx
        class Test2 {
          constructor() {
            Test2.prototype.name = 3;
          }
        }
        const test2 = new Test2();
        console.log(test2.__proto__); // { name: 3 }
        console.log(Object.getOwnPropertyDescriptors(test2.__proto__));
        // æ‰“å°
        {
          constructor: {
            value: [class Test2],
            writable: true,
            enumerable: false,
            configurable: true
          },
          name: { value: 3, writable: true, enumerable: true, configurable: true }
        }
        ```
        
        - å¯ä»¥åœ¨æ„é€ å‡½æ•°ä¸­ç›´æ¥è·å–ç±»çš„åŸå‹å±æ€§ç„¶åå®šä¹‰åŸå‹çš„åŸå§‹å€¼æˆ–å¯¹è±¡å±æ€§æˆå‘˜
        - ä½†æ˜¯**ä¸èƒ½**[é‡å†™ç±»çš„åŸå‹](4%20%E7%B1%BB/%E3%80%90%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3ES6%E3%80%91JavaScript%E4%B8%AD%E7%9A%84%E7%B1%BB.md)
            - åœ¨æ„é€ å‡½æ•°å†…éƒ¨é‡å†™åŸå‹
                - å¦‚æœä¸é€šè¿‡ç±»å®ä¾‹åŒ–å¾—åˆ°å¯¹è±¡ï¼ˆå³ä¸è°ƒç”¨ç±»çš„`constructor`æ„é€ æ–¹æ³•ï¼‰JavaScriptä¸€èˆ¬æƒ…å†µä¸ä¼šæŠ¥é”™ï¼Œè¯­æ³•æ²¡æœ‰é—®é¢˜
                - ä½†æ˜¯ä¸€æ—¦å®ä¾‹åŒ–ï¼Œå› ä¸ºç±»æœ¬èº«çš„ä»£ç å¼ºåˆ¶è¦æ±‚åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹è¿è¡Œï¼Œæ‰€ä»¥ä¼šæŠ¥å‡ºç±»å‹é”™è¯¯ï¼Œå³åŸå‹ä¸å¯è¯»
            - åœ¨æ„é€ å‡½æ•°å¤–éƒ¨ï¼ˆç±»å¤–éƒ¨ï¼‰é‡å†™åŸå‹
                - å¦‚æœè„šæœ¬éä¸¥æ ¼æ¨¡å¼ï¼Œè¯¥è¯­å¥ä¼šè¢«å¿½ç•¥ï¼Œä¸ä¼šæŠ¥é”™
                - å¦‚æœè„šæœ¬æ˜¯ä¸¥æ ¼æ¨¡å¼çš„ï¼Œæ‰§è¡Œè¯¥è¯­å¥æ—¶ä¼šæŠ¥é”™ï¼ŒæŠ›å‡ºç±»å‹é”™è¯¯

### 4.3.2.2 è®¿é—®å™¨

- ç±»å®šä¹‰æ”¯æŒè·å–å’Œè®¾ç½®è®¿é—®å™¨ï¼Œå…³äºè®¿é—®å™¨çš„è¯­æ³•å¯ä»¥æŸ¥çœ‹[getterä¸setter](../../JavaScript%E5%B0%8F%E8%AE%A1/getter%E4%B8%8Esetter.md)
- ç›´æ¥åœ¨ç±»å—ä¸­å®šä¹‰è®¿é—®å™¨çš„è¯­æ³•å’Œåœ¨æ™®é€šå¯¹è±¡ï¼ˆå­—é¢é‡ï¼‰ä¸­å®šä¹‰çš„è¯­æ³•ç±»ä¼¼
- ä¾‹å­
    
    ```jsx
    class Person {
      set name(newName) {
        this.name_ = newName;
      }
      get name() {
        return this.name_;
      }
    }
    const person = new Person();
    console.log(person); // Person {}
    person.name = "mangwu";
    console.log(person); // Person { name_: 'mangwu' }
    ```
    
    - å®é™…ä¸Šç±»å¹¶æ²¡æœ‰å®šä¹‰`name_` æˆå‘˜ï¼Œæ‰€ä»¥åˆæ¬¡æ‰“å°æ˜¯`person` ä¸­æ˜¯æ²¡æœ‰`name_` å±æ€§çš„
    - ä½†æ˜¯é€šè¿‡`person.name` ä¸ºè®¿é—®å™¨å±æ€§èµ‹å€¼ï¼Œé—´æ¥è°ƒç”¨`setter` æ–¹æ³•ï¼Œä¼šä¸ºå®ä¾‹æ·»åŠ `name_` å±æ€§
    - å’Œç±»æ–¹æ³•æˆå‘˜ä¸€æ ·ï¼Œè®¿é—®å™¨å±æ€§ä¹Ÿæ˜¯å®šä¹‰åœ¨åŸå‹ä¸Šçš„ï¼Œå¦‚ä¸‹æ˜¯ç±»åŸå‹çš„å±æ€§ç‰¹å¾
        
        ![Untitled](4%20%E7%B1%BB/Untitled%205.png)
        
    - æµè§ˆå™¨ä¸ºäº†æ›´å¥½çš„è¿›è¡Œåˆ†è¾©ï¼Œ`person`å¯¹è±¡çš„è®¿é—®å™¨å±æ€§ä¼šåœ¨è‡ªæœ‰å±æ€§ä¸­æœ‰æ˜¾ç¤ºï¼ˆä½†æ˜¯å®é™…ä¸Š**ä¸å­˜åœ¨**ä¸€ä¸ªå«nameçš„æ•°æ®å±æ€§ï¼‰
        
        ![Untitled](4%20%E7%B1%BB/Untitled%206.png)
        

## 4.3.3 é™æ€ç±»æ–¹æ³•

- é™æ€ç±»æ–¹æ³•ï¼ˆstatic class methodï¼‰æ˜¯å±äºç±»å¯¹è±¡æœ¬èº«çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯ç±»çš„`prototype` å±æ€§æˆ–å®ä¾‹æ–¹æ³•
- é™æ€ç±»æ–¹æ³•é€šå¸¸ç”¨äºæ‰§è¡Œä¸ç‰¹å®šäºå®ä¾‹çš„æ“ä½œï¼Œä¹Ÿä¸è¦æ±‚å­˜åœ¨ç±»çš„å®ä¾‹
- è¯­æ³•
    
    ```jsx
    class ClassName{
    	static methodName() {
    		// thiså¼•ç”¨ç±»æœ¬èº«è€Œä¸æ˜¯å®ä¾‹å¯¹è±¡
    	}
    }
    ```
    
    - `methodName` å°±æ˜¯ä¸€ä¸ªé™æ€ç±»æ–¹æ³•ï¼Œå±äºä¸€ä¸ªé™æ€æˆå‘˜ï¼Œ`this` å¼•ç”¨ç±»æœ¬èº«ï¼›å…¶ä»–çš„è¯­æ³•å’ŒåŸå‹æˆå‘˜ç±»ä¼¼
- ä¾‹å­ï¼Œç®€å•ä¾‹å­
    
    ```jsx
    class Person {
      constructor() {
        this.locate = () => {
          console.log("instance", this);
        };
      }
      locate() {
        console.log("prototype", this);
      }
      static locate() {
        console.log("class", this);
      }
    }
    const person = new Person();
    person.locate(); // instance Person { locate: [Function (anonymous)] }
    person.__proto__.locate(); // prototype {}
    Person.locate(); // class [class Person]
    ```
    
    - ä¸ºäº†æ›´æ¸…æ™°çš„çœ‹å‡ºä¸‰ä¸ªæ–¹æ³•çš„ä½ç½®ï¼Œå‚è€ƒå¦‚ä¸‹`person`å®ä¾‹çš„æ‰“å°
        
        ![Untitled](4%20%E7%B1%BB/Untitled%207.png)
        
- ä¾‹å­ï¼šç±»é™æ€æ–¹æ³•éå¸¸é€‚åˆä½œä¸ºå®ä¾‹å·¥å‚ï¼›åŒæ—¶é™æ€æ–¹æ³•ä¹Ÿé€‚åˆä½œä¸ºä¸€äº›ä¸å¯¹è±¡æ— å…³çš„è®¡ç®—æ–¹æ³•ï¼Œå¦‚å†…ç½®å¯¹è±¡`Math` çš„è¯¸å¤šAPI
    
    ```jsx
    class Person2 {
      constructor(age) {
        this.age = age;
      }
      static createPerson() {
        return new Person2(Math.floor(Math.random() * 100));
      }
    }
    const p1 = Person2.createPerson();
    const p2 = Person2.createPerson();
    console.log(p1); // Person2 { age: 89 }
    console.log(p2); // Person2 { age: 34 }
    ```
    
    - ä¸Šè¿°çš„`createPerson` å°±æ˜¯ä¸€ä¸ªé™æ€ç±»æ–¹æ³•ï¼Œå®ƒç”Ÿæˆéšæœºå¹´é¾„çš„`Person2` å®ä¾‹

## 4.3.3.0 MDNè¡¥å……-ç±»é™æ€åˆå§‹åŒ–å—ï¼ˆClass static initialzation blocksï¼‰

[ç±»é™æ€åˆå§‹åŒ–å—ï¼ˆClass static initalization blocksï¼‰](4%20%E7%B1%BB/%E7%B1%BB%E9%9D%99%E6%80%81%E5%88%9D%E5%A7%8B%E5%8C%96%E5%9D%97%EF%BC%88Class%20static%20initalization%20blocks%EF%BC%89.md)

## 4.3.4 éå‡½æ•°åŸå‹å’Œç±»æˆå‘˜

- æ³¨æ„æ ‡é¢˜åº”è¯¥è¿™æ ·ç†è§£ â€œéå‡½æ•°çš„ åŸå‹æˆå‘˜ å’Œ ç±»æˆå‘˜ â€ å³è®²è¿°å¦‚ä½•å®šä¹‰ä¸æ˜¯å‡½æ•°çš„å±æ€§æˆå‘˜
- è™½ç„¶ç±»å®šä¹‰å¹¶ä¸æ˜¾ç¤ºæ”¯æŒåœ¨åŸå‹æˆ–ç±»ä¸Šæ·»åŠ æˆå‘˜æ•°æ®ï¼Œä½†æ˜¯åœ¨ç±»å¤–éƒ¨å¯ä»¥æ‰‹åŠ¨æ·»åŠ 
    
    
    ```jsx
    class Person {
      sayName() {
        console.log(`${Person.greeting}${this.name}`);
      }
    }
    const person = new Person();
    person.sayName(); // undefinedundefined
    // å®šä¹‰ç±»æˆå‘˜
    Person.greeting = "My name is ";
    
    // å®šä¹‰åŸå‹æˆå‘˜
    Person.prototype.name = "mangwu";
    person.sayName(); // My name is mangwu
    ```
    
- æ³¨æ„åœ¨**æ„é€ å‡½æ•°**ä¸­ä¹Ÿå¯ä»¥æ·»åŠ éå‡½æ•°çš„ç±»æˆå‘˜å’ŒåŸå‹æˆå‘˜ï¼Œå‚è€ƒ[4.3.2.1](4%20%E7%B1%BB.md) ï¼Œä½†è¿™ç§æ–¹å¼éœ€è¦å®ä¾‹åŒ–ä¸€æ¬¡åæ‰èƒ½æˆåŠŸï¼Œå¹¶ä¸æ¨è

<aside>
ğŸ’¡ æ³¨æ„ï¼šç±»å®šä¹‰ä¸­ä¹‹æ‰€ä»¥æ²¡æœ‰æ˜¾å¼æ”¯æŒæ·»åŠ æ•°æ®æˆå‘˜ï¼Œæ˜¯å› ä¸ºåœ¨å…±äº«ç›®æ ‡ï¼ˆåŸå‹å’Œç±»ï¼‰ä¸Šæ·»åŠ å¯å˜ï¼ˆå¯ä¿®æ”¹ï¼‰æ•°æ®æˆå‘˜æ˜¯ä¸€ç§**åæ¨¡å¼ã€‚**ä¸€èˆ¬æ¥è¯´ï¼Œå¯¹è±¡å®ä¾‹åº”è¯¥ç‹¬è‡ªæ‹¥æœ‰é€šè¿‡`this`å¼•ç”¨çš„æ•°æ®

</aside>

- ä¸Šè¿°æ˜¯JavaScripté«˜çº§ç¨‹åºè®¾è®¡ä¸­çš„æ³¨æ„äº‹é¡¹**åŸè¯**ï¼Œå…¶å®åœ¨å…±äº«ç›®æ ‡ä¸Šæ·»åŠ æ•°æ®æˆå‘˜ä»ç„¶æ˜¯æœ‰åº”ç”¨åœºæ™¯çš„ï¼Œå¦‚`Math` ä¸Šå®šä¹‰çš„ä¸€äº›æ•°å­¦å¸¸é‡ï¼Œéƒ½æ˜¯ç±»æˆå‘˜ï¼›å¹¶ä¸”â€œ*æ²¡æœ‰æ˜¾å¼æ”¯æŒæ·»åŠ æ•°æ®æˆå‘˜*â€è¿™å¥è¯æ˜¯ä¸å¤ªå¯¹çš„ï¼Œå°±åƒ[4.3.2.1](4%20%E7%B1%BB.md) ä¸­æåˆ°çš„â€ç›´æ¥åœ¨ç±»å—ä¸­ä½¿ç”¨èµ‹å€¼è¯­å¥æ˜¯å¯ä»¥ç»™**å®ä¾‹**æ·»åŠ åŸå§‹å€¼æˆ–å¯¹è±¡ä½œä¸ºæˆå‘˜æ•°æ®çš„â€œï¼ŒåŒæ ·ï¼Œå¯ä»¥ä½¿ç”¨`static` å…³é”®å­—ä¿®é¥°èµ‹å€¼è¯­å¥çš„å˜é‡æ ‡è¯†ç¬¦ï¼Œè¿™æ ·å°±å¯ä»¥ç»™ç±»æ·»åŠ åŸå§‹å€¼æˆ–å¯¹è±¡ä½œä¸ºç±»æœ¬èº«çš„è‡ªæœ‰å±æ€§äº†
    
    
    ```jsx
    class Person {
    	static constitute = ["åŒ–å­¦ç»„æˆ", "è¡€æ¶²", "è‚Œè‚‰", "éª¨éª¼", "å¤§è„‘", "å››å¤§ç»„ç»‡"]; 
    }
    console.log(Person.constitute); // ["åŒ–å­¦ç»„æˆ", "è¡€æ¶²", "è‚Œè‚‰", "éª¨éª¼", "å¤§è„‘", "å››å¤§ç»„ç»‡"]
    ```
    
    ![Untitled](4%20%E7%B1%BB/Untitled%208.png)
    

## 4.3.5 è¿­ä»£å™¨ä¸ç”Ÿæˆå™¨æ–¹æ³•

- ç±»å®šä¹‰è¯­æ³•æ”¯æŒåœ¨åŸå‹å’Œç±»æœ¬èº«ä¸Šå®šä¹‰ç”Ÿæˆå™¨æ–¹æ³•ï¼Œè¯­æ³•å¦‚ä¸‹
    
    ```jsx
    class ClassName {
    	// åœ¨åŸå‹ä¸Šå®šä¹‰ç”Ÿæˆå™¨æ–¹æ³•
    	* [iteratorName]() {
    		
    	}
    	// åœ¨ç±»ä¸Šå®šä¹‰ç”Ÿæˆå™¨æ–¹æ³•
    	static * [staticIteratorName]() {
    
    	}
    }
    ```
    
    - `iteratorName` æ˜¯å®šä¹‰åœ¨ç±»åŸå‹ä¸Šçš„ç”Ÿæˆå™¨æ–¹æ³•ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æ•°å­—ã€ç¬¦å·ã€è¡¨è¾¾å¼ï¼Œå¦‚æœè¦æ·»åŠ ä¸€ä¸ªé»˜è®¤çš„è¿­ä»£å™¨ï¼ŒæŠŠç±»å®ä¾‹å˜ä¸ºå¯è¿­ä»£å¯¹è±¡ï¼Œç›´æ¥ä½¿ç”¨å†…ç½®è¿­ä»£å™¨ç¬¦å·`Symbol.iterator` ï¼ˆå³å°†`iteratortName` è®¾ç½®ä¸ºè¯¥å†…ç½®è¿­ä»£å™¨ç¬¦å·ï¼‰
    - `staticIteratorName` æ˜¯å®šä¹‰åœ¨ç±»ä¸Šçš„ç”Ÿæˆå™¨æ–¹æ³•ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æ•°å­—ã€ç¬¦å·ã€è¡¨è¾¾å¼ï¼Œå¦‚æœè¦ä¸ºç±»æ·»åŠ ä¸€ä¸ªé»˜è®¤çš„è¿­ä»£å™¨ï¼ŒæŠŠç±»æœ¬èº«å˜ä¸ºå¯è¿­ä»£å¯¹è±¡ï¼Œç›´æ¥ä½¿ç”¨å†…ç½®è¿­ä»£å™¨ç¬¦å·`Symbol.iterator` ï¼ˆå³å°†`staticIteratorName` è®¾ç½®ä¸ºè¯¥å†…ç½®è¿­ä»£å™¨ç¬¦å·ï¼‰
- ä¾‹å­
    
    ```jsx
    class Person {
      static *[Symbol.iterator]() {
        yield* ["åŒ–å­¦ç»„æˆ", "è¡€æ¶²", "è‚Œè‚‰", "éª¨éª¼", "å¤§è„‘", "å››å¤§ç»„ç»‡"];
      }
      constructor() {
        this.nicknames = ["mangwu", "wumang", "mangmang"];
      }
      *[Symbol.iterator]() {
        yield* this.nicknames.entries();
      }
    }
    
    for (const item of Person) {
      console.log(item);
    }
    const p = new Person();
    for (const [key, val] of p) {
      console.log(key, val);
    }
    // æ‰“å°ç»“æ„
    åŒ–å­¦ç»„æˆ
    è¡€æ¶²
    è‚Œè‚‰
    éª¨éª¼
    å¤§è„‘
    å››å¤§ç»„ç»‡
    0 mangwu
    1 wumang
    2 mangmang
    ```
    

# 4.4 ç»§æ‰¿

[3. ç»§æ‰¿](3%20%E7%BB%A7%E6%89%BF.md) èŠ±è´¹äº†å¤§é‡ç¯‡å¹…è®¨è®ºES5çš„ç»§æ‰¿æœºåˆ¶ï¼ŒECMAScript6æ–°å¢ç‰¹æ€§ä¸­æœ€å‡ºè‰²çš„ä¸€ä¸ªå°±æ˜¯**åŸç”Ÿæ”¯æŒäº†ç±»ç»§æ‰¿æœºåˆ¶**

è™½ç„¶ç±»ç»§æ‰¿ä½¿ç”¨çš„æ˜¯æ–°è¯­æ³•ï¼Œä½†æ˜¯èƒŒåä¾æ—§ä½¿ç”¨çš„æ˜¯åŸå‹é“¾

## 4.4.1 ç»§æ‰¿åŸºç¡€

- ES6ç±»æ”¯æŒ**å•ç»§æ‰¿**
- ä½¿ç”¨`extends` å…³é”®å­—ï¼Œå°±å¯ä»¥ç»§æ‰¿ä»»ä½•æ‹¥æœ‰[[[Construct]]](https://tc39.es/ecma262/multipage/ordinary-and-exotic-objects-behaviours.html#sec-ecmascript-function-objects-construct-argumentslist-newtarget)å’ŒåŸå‹çš„å¯¹è±¡
- ä¸ºäº†ä¿æŒå‘ä¸‹å…¼å®¹ï¼Œç±»ä¸ä»…å¯ä»¥ç»§æ‰¿ä¸€ä¸ªç±»ï¼Œä¹Ÿå¯ä»¥ç»§æ‰¿ä¸€ä¸ªæ™®é€šçš„æ„é€ å‡½æ•°
- ä¾‹å­
    
    ```jsx
    class Vehicle {
      constructor(speed) {
        // é€Ÿåº¦ km/h
        this.speed = speed;
      }
      saySpeed() {
        console.log(this.speed);
      }
    }
    
    class Bus extends Vehicle {
      constructor(speed, fuel) {
        super(speed);
        // è€—æ²¹ l/km
        this.fuel = fuel;
      }
    	// é¸£ç¬›
      makeSound() {
        console.log("å‘œå‘œå‘œï¼Œå‘œå‘œå‘œ");
      }
    }
    const vehicle = new Vehicle(0);
    const bus = new Bus(40, 0.1);
    bus.saySpeed(); // 40
    bus.makeSound(); // å‘œå‘œå‘œï¼Œå‘œå‘œå‘œ
    console.log(bus instanceof Bus); // true
    console.log(bus instanceof Vehicle); // true
    ```
    
    - `Bus` æ˜¯ç»§æ‰¿`Vehicle` ï¼Œå®ƒæ˜¯`Vehicle`çš„**æ´¾ç”Ÿç±»ï¼ˆderived classï¼‰**
    - æ´¾ç”Ÿç±»éƒ½ä¼šé€šè¿‡åŸå‹é“¾è®¿é—®åˆ°ç±»å’ŒåŸå‹ä¸Šå®šä¹‰çš„æ–¹æ³•ï¼Œ`this` å€¼ä¼šåæ˜ è°ƒç”¨ç›¸åº”æ–¹æ³•çš„å®ä¾‹æˆ–ç±»
    - ä¸‹é¢æ˜¯ä¸Šè¿°ä¾‹å­çš„åŸå‹é“¾å¯è§†åŒ–
        
        ![ç±»ç»§æ‰¿.png](4%20%E7%B1%BB/%25E7%25B1%25BB%25E7%25BB%25A7%25E6%2589%25BF.png)
        
    - å®é™…ä¸Šå’Œ**å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿** çš„[å¯è§†åŒ–å›¾](3%20%E7%BB%A7%E6%89%BF.md)åŸºæœ¬ä¸€æ ·ï¼Œåº•å±‚åŸç†ä»ç„¶ä¾é åŸå‹é“¾

<aside>
ğŸ’¡ æ³¨æ„ï¼š`extends` å…³é”®å­—ä¹Ÿå¯ä»¥ç”¨åœ¨ç±»è¡¨è¾¾å¼ä¸­ï¼Œå› æ­¤`let Bar = class extends Foo{}` ä¹Ÿæ˜¯æœ‰æ•ˆçš„è¯­æ³•

</aside>

## 4.4.2 æ„é€ å‡½æ•°ã€HomeObjectå’Œsuper()

### 4.4.2.1 super

- æ´¾ç”Ÿç±»çš„æ–¹æ³•å¯ä»¥é€šè¿‡`super`å…³é”®å­—å¼•ç”¨å®ƒä»¬çš„**åŸå‹(**å³**æ´¾ç”Ÿç±»æˆ–æ´¾ç”Ÿç±»prototypeå±æ€§çš„åŸå‹)**
    - ~~è¿™ä¸ªå…³é”®å­—åªèƒ½åœ¨æ´¾ç”Ÿç±»ä¸­ä½¿ç”¨~~ ï¼ˆJavaScripté«˜çº§ç¨‹åºè®¾è®¡ç¬¬4ç‰ˆçš„é”™è¯¯ï¼Œå¯ä»¥åœ¨å­—é¢é‡å¯¹è±¡ä¸­ä½¿ç”¨ï¼‰
    - åœ¨æ´¾ç”Ÿç±»ä¸­ï¼Œåªç”¨åœ¨æ„é€ å‡½æ•°ã€å®ä¾‹æ–¹æ³•å’Œé™æ€æ–¹æ³•å†…éƒ¨ï¼ˆè¿˜å¯ä»¥ç”¨åœ¨ç±»åˆå§‹åŒ–çš„èµ‹å€¼è¯­å¥ä¸­ï¼‰
    - åœ¨ç±»æ„é€ å‡½æ•°ä¸­ä½¿ç”¨`super()` å¯ä»¥è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼ˆç›¸å½“äº**ç›—ç”¨æ„é€ å‡½æ•°**ï¼‰
- `super`æ˜¯ä¸€ä¸ªæ“ä½œç¬¦å…³é”®å­—ï¼Œå®ƒæ— æ³•è¢«æ‰“å°ï¼Œç”¨äºè®¿é—®å¯¹è±¡å­—é¢é‡(object literal)æˆ–ç±»çš„[[Prototype]]ã€è°ƒç”¨è¶…ç±»(invoke)çš„æ„é€ å‡½æ•°
    - `super.prop` å’Œ`super[expr]` è¡¨è¾¾å¼åœ¨ä»»ä½•çš„ç±»æˆ–å¯¹è±¡å­—é¢é‡ï¼ˆobject literalï¼‰çš„æ–¹æ³•å®šä¹‰ï¼ˆmethod definitionï¼‰ä¸­éƒ½æ˜¯åˆæ³•çš„
    - `super(â€¦args)` è¡¨è¾¾å¼ä»…åœ¨ç±»æ„é€ å‡½æ•°ä¸­åˆæ³•
- è¯­æ³•
    
    ```jsx
    super([arguments]); // è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°
    super.propertyOnParent;
    super[expression]; // ä¸­æ‹¬å·è°ƒç”¨æ³•æ–¹ä¾¿ä¸èƒ½ç›´æ¥ç”¨å­—ç¬¦ä¸²è¡¨ç¤ºçš„å±æ€§è°ƒç”¨
    ```
    

<aside>
ğŸ’¡ æ³¨æ„ï¼šsuperå…³é”®å­—åªèƒ½è¢«ç”¨äºä¸¤ç§æ–¹å¼ï¼šä½œä¸ºæ–¹æ³•è¢«è°ƒç”¨ï¼ˆ`super(...args)`ï¼‰æˆ– ä½œä¸ºâ€**å±æ€§æŸ¥è¯¢å™¨**â€(**property lookup**)(super.prop å’Œ super[expr])ã€‚superä¸èƒ½è¢«**å•ç‹¬**ä½¿ç”¨ï¼Œå› ä¸ºå®ƒ**ä¸æ˜¯**ä¸€ä¸ªæŒ‡å‘åŸå‹å¯¹è±¡çš„å˜é‡ï¼Œè¯•å›¾æ‰“å°`super` ä¼šå‡ºè¯­æ³•é”™è¯¯

```jsx
const child = {
	myParent() {
		console.log(super); // Syntax Error: "super" keyword unepected here
	}
}
```

</aside>

- åœ¨æœ‰æ„é€ ä½“ï¼ˆconstructor bodyï¼‰çš„æ´¾ç”Ÿç±»ï¼ˆderived classï¼‰ä¸­ï¼Œ`super` å…³é”®å­—å¯ä»¥ä»¥**å‡½æ•°è°ƒç”¨**ï¼ˆ**function call**ï¼‰å½¢å¼è¢«è°ƒç”¨ï¼ˆ`super(â€¦args)`ï¼‰å¹¶ä¸”åœ¨æ„é€ å‡½æ•°ä¸­åº”è¯¥**åœ¨`this` è¢«ä½¿ç”¨ä¹‹å‰**ä»¥åŠ`**return` è¯­å¥ä¹‹å‰**è¢«ä½¿ç”¨ï¼›åœ¨æ„é€ å‡½æ•°ä¸­çš„`super(â€¦args)` ä¼šè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œå¹¶ä¸ºç»‘å®šçˆ¶ç±»çš„**å…¬å…±å­—æ®µ**ï¼ˆ**public fields**ï¼‰ä»¥ä¾¿æ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°è¿›ä¸€æ­¥è®¿é—®å’Œä¿®æ”¹`this`
- å±æ€§æŸ¥è¯¢å™¨å¼ï¼ˆproperty lookupï¼‰çš„`super`è¯­æ³•ç”¨äºè®¿é—®æ–¹æ³•ã€å¯¹è±¡å­—é¢é‡çš„å±æ€§æˆ–ç±»çš„[[Property]]ç‰¹æ€§ï¼›åœ¨ä¸€ä¸ªç±»ä¸»ä½“ä¸­ï¼Œsuperçš„å¼•ç”¨å¯ä»¥æ˜¯è¶…ç±»çš„æ„é€ å‡½æ•°ï¼ˆconstructorï¼‰æœ¬èº«æˆ–æ„é€ å‡½æ•°çš„åŸå‹`prototype` ï¼Œè¿™å–å†³äºæŒ‡å‘ä¸Šä¸‹æ–‡æ˜¯**å®ä¾‹åˆ›å»º**(**instance creation**)æˆ–**ç±»åˆå§‹åŒ–**(class initialization)
- æ³¨æ„`super`çš„å¼•ç”¨æ˜¯ç”±å£°æ˜çš„ç±»æˆ–å¯¹è±¡å­—é¢é‡å†³å®šçš„ï¼Œè€Œä¸æ˜¯è°ƒç”¨æ–¹æ³•çš„å¯¹è±¡ï¼Œå› æ­¤è§£ç»‘ï¼ˆunbindingï¼‰æˆ–é‡ç»‘å®šï¼ˆre-bindingï¼‰ä¸€ä¸ªæ–¹æ³•å¹¶ä¸ä¼šæ”¹å˜`super`åœ¨å…¶ä¸­çš„å¼•ç”¨ï¼ˆä¼šæ”¹å˜`this`çš„å¼•ç”¨ï¼‰ï¼›å¯ä»¥å°†`super` è§†ä¸ºç±»æˆ–å¯¹è±¡å­—é¢é‡ä½œç”¨åŸŸï¼ˆscopeï¼‰çš„ä¸€ä¸ªå˜é‡ï¼Œæ–¹æ³•åœ¨æ•´ä¸ªä½œç”¨åŸŸä¸­åˆ›å»ºé—­åŒ…ï¼ˆä½†å®é™…ä¸Š`super` ä¸æ˜¯ä¸€ä¸ªå˜é‡è€Œæ˜¯ä¸€ä¸ªå…³é”®å­—æ“ä½œç¬¦ï¼‰
- ä¾‹å­
    
    [Superå…³é”®å­—ä½¿ç”¨çš„ä¾‹å­](4%20%E7%B1%BB/Super%E5%85%B3%E9%94%AE%E5%AD%97%E4%BD%BF%E7%94%A8%E7%9A%84%E4%BE%8B%E5%AD%90.md)
    
    å…³äºå­ç±»æ„é€ å‡½æ•°ä¸ä½¿ç”¨`super()` çš„æƒ…å†µï¼šå­ç±»æ„é€ å‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¦åˆ™å¿…é¡»åœ¨`this`ä½¿ç”¨å‰è°ƒç”¨`super()`
    
    ```jsx
    class Vehicle{
    	constructor() {
        this.hasEngine = true;
      }
    }
    class Car extends Vehicle {} // é»˜è®¤è°ƒç”¨super
    class Van extends Vehicle {
      constructor() {
        return {}; // ä¸è°ƒç”¨super
      }
    }
    console.log(new Car()); // Car { hasEngine: true }
    console.log(new Van()); // {}
    ```
    

### 4.4.2.2 [[HomeObject]]

- ä¸åŒäº`this` æŒ‡é’ˆï¼Œ`this` æ˜¯è‡ªæœ‰çš„ï¼Œå®ƒå¯ä»¥æŒ‡å‘å¼€å‘è€…æƒ³è¦å®ƒæŒ‡å‘çš„å¼•ç”¨ï¼Œä¸”ä¼šæ ¹æ®è°ƒç”¨è€…è€Œæ”¹å˜
- è€ŒES6ç»™æ„é€ å‡½æ•°å’Œé™æ€æ–¹æ³•æ·»åŠ äº†å†…éƒ¨ç‰¹æ€§[[HomeObject]], è¿™ä¸ªç‰¹æ€§æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘å®šä¹‰è¯¥æ–¹æ³•çš„å¯¹è±¡
    - è¿™ä¸ªæŒ‡é’ˆæŒ‡é’ˆè‡ªåŠ¨èµ‹å€¼ï¼Œä¸”åªèƒ½åœ¨JavaScriptå¼•æ“å†…éƒ¨è®¿é—®ï¼ˆå¼€å‘è€…æ— æ³•ç›´æ¥è·å–ï¼‰
    - `super`å§‹ç»ˆä¼šå®šä¹‰ä¸º[[HomeObject]]çš„åŸå‹
- åœ¨ç±»ä¸­
    - é™æ€ç¯å¢ƒä¸‹ï¼Œ[[HomeObject]]å°±æ˜¯ç±»æœ¬èº«ï¼Œæ‰€ä»¥`super` å¼•ç”¨çš„å°±æ˜¯ç±»çš„[[Prototype]]ç‰¹æ€§ï¼ˆè¶…åˆ©å„çš„æ„é€ å‡½æ•°æœ¬èº«ï¼‰
    - éé™æ€ç¯å¢ƒä¸‹ï¼ˆåŒ…æ‹¬æ„é€ å‡½æ•°ï¼‰ï¼Œ[[HomeObject]]å°±æ˜¯ç±»çš„`prototype`å±æ€§ï¼ˆå› ä¸ºéé™æ€æ–¹æ³•å®šä¹‰åœ¨ç±»çš„`prototype`ä¸Šï¼‰ï¼Œ æ‰€ä»¥`super` å¼•ç”¨çš„å°±æ˜¯prototypeå±æ€§çš„[[Prototype]]ç‰¹æ€§ï¼Œå³çˆ¶ç±»çš„prototypeå±æ€§

## 4.4.3 æŠ½è±¡åŸºç±»

- æŠ½è±¡åŸºç±»ï¼šä¾›å…¶å®ƒç±»ç»§æ‰¿ï¼Œä½†æœ¬èº«ä¸ä¼šè¢«å®ä¾‹åŒ–
- ECMAScriptæ²¡æœ‰ä¸“é—¨æ”¯æŒè¿™ç§ç±»çš„è¯­æ³•ï¼Œå…¶å®ƒè¯­è¨€ä½¿ç”¨`abstract` ä¿®é¥°ç¬¦ä½œä¸ºå®šä¹‰æŠ½è±¡åŸºç±»çš„å…³é”®å­—ï¼Œåœ¨ECMAScript `abstract` ä½œä¸ºä¿ç•™å­—åœ¨æœªæ¥ä½¿ç”¨
- è¦å®ç°ECMAScriptä¸­çš„æŠ½è±¡åŸºç±»ï¼Œéœ€è¦åˆ©ç”¨`new.target` å…³é”®å­—æ“ä½œç¬¦ï¼Œ`new.target` ä¿å­˜é€šè¿‡`new`è°ƒç”¨çš„ç±»æˆ–å‡½æ•°
- ç±»åœ¨å®ä¾‹åŒ–æ—¶å¿…é¡»ä½¿ç”¨`new`å…³é”®å­—ï¼Œæ‰€ä»¥ä½¿ç”¨`new + åŸºç±»` è°ƒç”¨æ—¶ï¼Œåœ¨ç±»æ„é€ å‡½æ•°ä¸­`new.target` å°±æ˜¯åŸºç±»æœ¬èº«ï¼Œè€Œç»§æ‰¿äºæŠ½è±¡åŸºç±»çš„å­ç±»ï¼Œåœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¸­ä½¿ç”¨`super(â€¦args)` è°ƒç”¨äº†åŸºç±»çš„æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥åŸºç±»çš„ç±»æ„é€ å‡½æ•°ä¸­çš„`new.target` å°±æ˜¯å­ç±»æœ¬èº« ï¼Œæ•…è€Œå¯ä»¥é€šè¿‡æ¡ä»¶åˆ¤æ–­è°ƒç”¨è€…
    
    ```jsx
    class Vehicle {
      constructor() {
        console.log(new.target);
        if (new.target === Vehicle) {
          throw new Error("æŠ½è±¡åŸºç±» Vehicleä¸èƒ½è¢«å®ä¾‹åŒ–");
        }
      }
    }
    class Bus extends Vehicle {
      constructor() {
        super();
      }
    }
    
    const b = new Bus(); // [class Bus extends Vehicle]
    try {
      new Vehicle(); // [class Vehicle]
    } catch (error) {
      console.log(error.toString()); // Error: æŠ½è±¡åŸºç±» Vehicleä¸èƒ½è¢«å®ä¾‹åŒ–
    }
    ```
    
- å¦å¤–é€šè¿‡åœ¨åŸºç±»çš„æ„é€ å‡½æ•°ä¸­è¿›è¡Œæ£€æŸ¥ï¼Œå¯ä»¥è¦æ±‚æ´¾ç”Ÿç±»å¿…é¡»å®šä¹‰æŸä¸ªæ–¹æ³•ï¼Œå› ä¸ºåŸå‹æ–¹æ³•åœ¨è°ƒç”¨ç±»æ„é€ å‡½æ•°ä¹‹é—´å°±å·²ç»å­˜åœ¨ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡`this`ï¼ˆå­ç±»çš„å®ä¾‹ï¼‰å…³é”®å­—æ£€æŸ¥ç›¸åº”çš„æ–¹æ³•
    
    ```jsx
    class A {
      constructor() {
        if (new.target === A) {
          throw new Error("æŠ½è±¡åŸºç±»Aä¸èƒ½è¢«å®ä¾‹åŒ–");
        }
        if (new.target === B) {
          if (!this.foo) {
            throw new Error("æ´¾ç”Ÿç±»Bå¿…é¡»å®šä¹‰foo()");
          }
        }
        if (new.target === C) {
          if (!this.bar) {
            throw new Error("æ´¾ç”Ÿç±»Cå¿…é¡»å®šä¹‰bar()");
          }
        }
      }
    }
    class B extends A {}
    class C extends A {}
    
    try {
      new B();
    } catch (error) {
      console.log(error.message); // æ´¾ç”Ÿç±»Bå¿…é¡»å®šä¹‰foo()
    }
    try {
      new C();
    } catch (error) {
      console.log(error.message); // æ´¾ç”Ÿç±»Cå¿…é¡»å®šä¹‰bar()
    }
    ```
    
- å…³äº`new.target`çš„è·Ÿå¤šä¿¡æ¯å¦‚ä¸‹ï¼Œå‚è€ƒ[mdn](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/new.target)
    
    [new.target](4%20%E7%B1%BB/new%20target.md)
    

## 4.4.4 ç»§æ‰¿å†…ç½®ç±»å‹

ES6ä¸ºç±»çš„ç»§æ‰¿å†…ç½®å¼•ç”¨ç±»å‹æä¾›äº†é¡ºç•…çš„æœºåˆ¶ï¼Œå¼€å‘è€…å¯ä»¥æ–¹ä¾¿çš„æ‰©å±•å†…ç½®ç±»å‹

- ä¾‹å¦‚ç»§æ‰¿æ•°ç»„ï¼Œæ–°å»ºåŸå‹æ–¹æ³•
    
    ```jsx
    class SuperArray extends Array {
      shuffle() {
        for (let i = 0; i < this.length; i++) {
          const j = Math.floor(Math.random() * (i + 1));
          [this[i], this[j]] = [this[j], this[i]];
        }
        return this;
      }
    }
    const a = SuperArray.from([1, 2, 3, 4, 5, 6, 7]);
    console.log(a); // SuperArray(7) [1, 2, 3, 4,5, 6, 7]
    a.shuffle()
    console.log(a); // SuperArray(7) [6, 1, 4, 5, 7, 3, 2]
    console.log(a instanceof Array); // true
    console.log(a instanceof SuperArray); // true
    ```
    
- æœ‰äº›å†…ç½®å¯¹è±¡çš„æ–¹æ³•ä¼šè¿”å›æ–°å®ä¾‹ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿”å›çš„æ–°å®ä¾‹å’ŒåŸå§‹å®ä¾‹çš„ç±»å‹æ˜¯ä¸€è‡´çš„
    
    ```jsx
    const filterA = a.filter((v) => v % 2);
    console.log(filterA); // SuperArray(4) [ 7, 5, 3, 1 ]
    console.log(filterA instanceof SuperArray); // true
    ```
    
    - ç»§æ‰¿ä¼šä½¿å¾—æ´¾ç”Ÿç±»çš„è¿”å›ç›¸åŒç±»å‹çš„åŸå‹æ–¹æ³•è¿”å›æ´¾ç”Ÿç±»å‹çš„å®ä¾‹
- è¦æ§åˆ¶è¿™ç§é»˜è®¤è¡Œä¸ºï¼Œå¯ä»¥è¦†ç›–`Symbol.species`è®¿é—®å™¨ï¼Œè¿™ä¸ªè®¿é—®å™¨å†³å®šåˆ›å»ºè¿”å›å®ä¾‹æ—¶ä½¿ç”¨çš„ç±»ï¼Œæ›´å¤šå…³äº`Symbol.species`å†…ç½®ç¬¦å·çš„ä¿¡æ¯å¯ä»¥æŸ¥çœ‹[8.Symbol.species](../3%20%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80/%E5%B8%B8%E7%94%A8%E5%86%85%E7%BD%AE%E7%AC%A6%E5%8F%B7.md)
    
    ```jsx
    class XArray extends Array {
      shuffle() {
        for (let i = 0; i < this.length; i++) {
          const j = Math.floor(Math.random() * (i + 1));
          [this[i], this[j]] = [this[j], this[i]];
        }
        return this;
      }
      static get [Symbol.species]() {
        return Array;
      }
    }
    
    const xarr = new XArray(1, 2, 3, 4, 5, 6, 7);
    console.log(xarr); // XArray(7) [1, 2, 3, 4,5, 6, 7]
    xarr.shuffle();
    const filterX = xarr.filter((v) => v % 2 == 0);
    console.log(filterX); // [ 6, 4, 2 ]
    console.log(filterX instanceof XArray); // false
    ```
    

## 4.4.5 ç±»æ··å…¥

- æŠŠä¸åŒç±»çš„è¡Œä¸ºé›†ä¸­åˆ°ä¸€ä¸ªç±»æ˜¯ä¸€ç§å¸¸è§çš„JavaScriptæ¨¡å¼
- ES6æ²¡æœ‰æ˜¾ç¤ºçš„æ”¯æŒå¤šç±»ç»§æ‰¿ï¼Œä½†æ˜¯é€šè¿‡ç°æœ‰ç‰¹æ€§å¯ä»¥è½»æ¾åœ°æ¨¡æ‹Ÿè¿™ç§è¡Œä¸º

<aside>
ğŸ’¡ æ³¨æ„ï¼šObject.assign() æ–¹æ³•æ˜¯ä¸ºäº†æ··å…¥å¯¹è±¡è¡Œä¸ºè€Œè®¾è®¡çš„ã€‚åªæœ‰åœ¨éœ€è¦æ··å…¥ç±»çš„è¡Œä¸ºæ—¶æ‰æœ‰å¿…è¦è‡ªå·±å®ç°æ··å…¥è¡¨è¾¾å¼ã€‚å¦‚æœåªæ˜¯éœ€è¦æ··å…¥å¤šä¸ªå¯¹è±¡çš„å±æ€§ï¼Œé‚£ä¹ˆä½¿ç”¨Object.assign()å°±å¯ä»¥äº†

</aside>

- åœ¨ç»§æ‰¿è¯­æ³•ä¸­ï¼Œ`extends`åçš„æ ‡è¯†ç¬¦å¯ä»¥æ˜¯ä¸€ä¸ªJavaScript`Expression` åªè¦è¿™ä¸ªè¡¨è¾¾å¼æœ€ç»ˆæ‰§è¡Œç»“æœæ˜¯ä¸€ä¸ªç±»æˆ–æ„é€ å‡½æ•°å³å¯
- åˆ©ç”¨è¿™ç§æ–¹å¼ï¼Œæ··å…¥æ¨¡å¼å¯ä»¥é€šè¿‡åœ¨ä¸€ä¸ªè¡¨è¾¾å¼ä¸­è¿ç¼€å¤šä¸ªæ··å…¥å…ƒç´ å®ç°ï¼Œè¿™ä¸ªè¡¨è¾¾å¼æœ€ç»ˆä¼šè§£ææˆä¸€ä¸ªç»§æ‰¿çš„ç±»
- ä¾‹å¦‚Personç±»éœ€è¦ç»„åˆAã€Bã€Cï¼Œåˆ™éœ€è¦ä¸€ç§æœºåˆ¶ä¸€æ¬¡å®ç°Bç»§æ‰¿Aï¼ŒCç»§æ‰¿Bï¼Œè€ŒPersonå†ç»§æ‰¿Cï¼Œä»è€ŒæŠŠAã€Bã€Cä¸‰ä¸ªç±»éƒ½ç»„åˆåˆ°Personä¸­

**å¯åµŒå¥—å‡½æ•°**

- å®šä¹‰ä¸€ç»„å¯åµŒå¥—çš„å‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ªè¶…ç±»ä½œä¸ºå‚æ•°ï¼Œç„¶ååœ¨å‡½æ•°ä½“å†…å°†ä¸´æ—¶å®šä¹‰çš„æ··å…¥ç±»ç»§æ‰¿ä¼ å…¥çš„å‚æ•°ï¼Œå¹¶è¿”å›ä¸´æ—¶å®šä¹‰çš„æ··å…¥ç±»
- è¿™äº›ç»„åˆå‡½æ•°å¯ä»¥è¿ç¼€è°ƒç”¨ï¼Œæœ€ç»ˆç»„åˆæˆè¶…ç±»è¡¨è¾¾å¼
    
    ```jsx
    class Vehicle {}
    
    let FooMin = (superclass) =>
      class extends superclass {
        foo() {
          console.log("foo");
        }
      };
    let BarMin = (superclass) =>
      class extends superclass {
        bar() {
          console.log("bar");
        }
      };
    let BazMin = (superclass) =>
      class extends superclass {
        baz() {
          console.log("Baz");
        }
      };
    
    class Bus extends FooMin(BarMin(BazMin(Vehicle))) {}
    const bus = new Bus();
    bus.foo();
    bus.bar();
    bus.baz();
    ```
    
    - è¿™ç§æ··å…¥æ–¹å¼å®é™…ä¸Šå°±æ˜¯å°†ä¸åŒçš„è¡Œä¸ºï¼ˆåŸå‹æ–¹æ³•ï¼‰æŒ‚è½½åˆ°ä¸åŒçš„**ä¸´æ—¶ç±»**ä¸Šï¼Œç±»é¡ºåºç»§æ‰¿ç»„æˆä¸€ä¸ªä¸´æ—¶è¶…ç±»ï¼Œè®©æœ€ç»ˆçš„å­ç±»èƒ½æ‹¥æœ‰è¿™äº›æ–°è¡Œä¸ºï¼Œé‚£äº›**ä¸´æ—¶ç±»**å†ä¸‹ä¸€æ¬¡ç»„åˆæ—¶åˆä¼šè¢«é‡æ–°åˆ›å»ºï¼Œä¸å®šä¹‰å®é™…çš„ç±»è¿›è¡Œé¡ºåºç»§æ‰¿è¿˜æ˜¯æœ‰åŒºåˆ«çš„

**å±•å¼€åµŒå¥—è°ƒç”¨**

- å½“éœ€è¦æ··å…¥çš„è¡Œä¸ºè¿‡å¤šæ—¶ï¼Œéœ€è¦åµŒå¥—çš„æ¬¡æ•°ä¹Ÿå°±å¾ˆå¤šäº†ï¼Œå¯ä»¥å†™ä¸€ä¸ª**è¾…åŠ©å‡½æ•°**ï¼ŒæŠŠåµŒå¥—è°ƒç”¨å±•å¼€ï¼Œç›´æ¥æŠŠæ‰€æœ‰éœ€è¦åŠ å…¥çš„è¡Œä¸ºä¼ å…¥åˆ°è¿™ä¸ªè¾…åŠ©å‡½æ•°ä¸­ï¼Œè®©è¿™ä¸ªè¾…åŠ©å‡½æ•°ç›´æ¥è¿”å›è¶…ç±»
    
    ```jsx
    // è¾…åŠ©å‡½æ•°
    function mix(BaseClass, ...mixins) {
      return mixins.reduce((pre, cur) => cur(pre), BaseClass);
    }
    
    class Car extends mix(Vehicle, BazMin, BarMin, FooMin) {}
    const car = new Car();
    car.foo();
    car.bar();
    car.baz();
    ```
    
- å®é™…ä¸Šè¿™ä¸ªè¾…åŠ©å‡½æ•°å°±æ˜¯æŠŠåµŒå¥—è°ƒç”¨åˆ†ç¦»åˆ°å‡½æ•°ä½“ä¸­ï¼Œä½¿ç”¨æ‰©å±•æ“ä½œç¬¦é…åˆ`reduce`æ–¹æ³•å®ç°å›ºå®šä»£ç åµŒå¥—è°ƒç”¨

<aside>
ğŸ’¡ æ³¨æ„ï¼šå¾ˆå¤šJavaScriptæ¡†æ¶ï¼ˆç‰¹åˆ«æ˜¯Reactï¼‰å·²ç»[æŠ›å¼ƒäº†æ··å…¥æ¨¡å¼](https://www.notion.so/10-8cce62006faa46da95d4661276079253)ï¼Œè½¬å‘äº†ç»„åˆæ¨¡å¼ï¼ˆæŠŠæ–¹æ³•æå–åˆ°ç‹¬ç«‹çš„ç±»å’Œè¾…åŠ©å¯¹è±¡ä¸­ï¼Œç„¶åæŠŠå®ƒä»¬ç»„åˆèµ·æ¥ï¼Œä½†ä¸ä½¿ç”¨ç»§æ‰¿ï¼‰ã€‚è¿™åæ˜ äº†é‚£ä¸ªä¼—æ‰€å‘¨çŸ¥çš„è½¯ä»¶è®¾è®¡åŸåˆ™ï¼šâ€œç»„åˆèƒœè¿‡ç»§æ‰¿ï¼ˆcomposition over inheritanceï¼‰ã€‚â€è¿™ä¸ªè®¾è®¡åŸåˆ™è¢«å¾ˆå¤šäººéµå¾ªï¼Œåœ¨ä»£ç è®¾è®¡ä¸­èƒ½æä¾›æå¤§çš„çµæ´»æ€§

</aside>