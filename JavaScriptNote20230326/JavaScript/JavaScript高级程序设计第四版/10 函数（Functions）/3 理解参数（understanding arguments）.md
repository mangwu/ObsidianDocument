# 3. ç†è§£å‚æ•°ï¼ˆunderstanding argumentsï¼‰

# 3.1 å‡½æ•°ç­¾å

ä¸ºäº†æ›´å¥½çš„ç†è§£JavaScriptä¸­çš„å‡½æ•°å‚æ•°ï¼Œå¯ä»¥å‚è€ƒ[ä¸ºä»€ä¹ˆç§°JavaScriptæ²¡æœ‰å‡½æ•°ç­¾å](../../JavaScript%E5%B0%8F%E8%AE%A1/JavaScript%E4%B8%8E%E5%87%BD%E6%95%B0%E7%AD%BE%E5%90%8D.md) 

## 3.1.1 ECMAScriptå‡½æ•°ä¼ é€’å‚æ•°ç‰¹æ€§

- ECMAScriptå‡½æ•°çš„å‚æ•°ï¼ˆargumentsï¼‰ä¸å…¶ä»–å¤§å¤šæ•°è¯­è¨€ä¸åŒï¼ŒECMAScriptå‡½æ•°æ—¢**ä¸å…³å¿ƒä¼ å…¥çš„å‚æ•°ä¸ªæ•°**ï¼Œä¹Ÿ**ä¸å…³å¿ƒè¿™äº›å‚æ•°çš„æ•°æ®ç±»å‹**
- å®šä¹‰å‡½æ•°æ—¶è¦æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œä½†å¹¶ä¸æ„å‘³ç€è°ƒç”¨æ—¶å°±ä¸€å®šè¦ä¼ é€’ä¸¤ä¸ªå‚æ•°ï¼Œå¯ä»¥ä¼ é€’ä¸¤ä¸ªï¼Œä¸‰ä¸ªï¼Œæ›´å¤šï¼Œç”šè‡³ä¸€ä¸ªä¸ä¼ ï¼Œè§£é‡Šå™¨ä¸ä¼šæŠ¥é”™ï¼ˆä½†æ˜¯æ‰§è¡Œæ—¶æœ‰å¯èƒ½æŠ¥é”™ï¼‰
- è¿™ä¸ªå‚æ•°ç‰¹æ€§ä¹Ÿè¢«ç§°ä¸ºâ€œ**JavaScriptæ²¡æœ‰å‡½æ•°ç­¾å**â€
    
    ```jsx
    function sum(num1, num2) {
      return num1 + num2;
    }
    
    console.log(sum()); // NaN
    console.log(sum(1)); // NaN
    console.log(sum(1, 2)); // 3
    console.log(sum("1", "2", 3)); // 12  (å­—ç¬¦ä¸²)
    ```
    

## 3.1.2 ä¸è®¾è®¡å‡½æ•°ç­¾åçš„åŸå› 

- å› ä¸º`ECMAScript`è®¾è®¡å‡ºäº†ä¸€ä¸ª`arguments` å¯¹è±¡ï¼Œå‡½æ•°çš„å‚æ•°åœ¨å‡½æ•°ä½“å†…éƒ¨è¡¨ç°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œè¿™ä¸ªå‚æ•°æ•°ç»„å°±æ˜¯`arguments` å¯¹è±¡
- å‡½æ•°è¢«è°ƒç”¨æ—¶æ€»ä¼šæ¥å—ä¸€ä¸ªæ•°ç»„ï¼Œä½†å‡½æ•°å¹¶ä¸å…³å¿ƒå‚æ•°æ•°ç»„ä¸­åŒ…å«ä»€ä¹ˆï¼Œå³ä½¿æ•°ç»„ä¸­æ²¡æœ‰å¦‚ä½•å…ƒç´ ï¼ˆæ²¡æœ‰ä¼ é€’å‚æ•°ï¼‰ï¼Œæˆ–è€…å…ƒç´ ä¸ªæ•°è¶…è¿‡å®šä¹‰æ—¶ä¼ é€’å‚æ•°çš„ä¸ªæ•°ï¼Œéƒ½æ²¡æœ‰å…³ç³»
- äº‹å®ä¸Šï¼Œåœ¨ä½¿ç”¨`function` å…³é”®å­—å®šä¹‰ï¼ˆéç®­å¤´ï¼‰å‡½æ•°æ—¶ï¼Œå°±å¯ä»¥åœ¨å‡½æ•°å†…éƒ¨è®¿é—®`arguments` å¯¹è±¡ï¼Œä»ä¸­è·å–ä¼ è¿›æ¥çš„æ¯ä¸ªå‚æ•°å€¼

## 3.1.3 `arguments`å¯¹è±¡

- `arguments` å¯¹è±¡æ˜¯ä¸€ä¸ªç±»æ•°ç»„å¯¹è±¡ï¼ˆä¸æ˜¯`Array`å®ä¾‹ï¼Œnodeç¯å¢ƒåŠæµè§ˆå™¨ç¯å¢ƒä¸‹éƒ½æ˜¾ç¤ºä¸º`Arguments`ç±»å‹å®ä¾‹ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨**ä¸­æ‹¬å·è¯­æ³•ï¼ˆbracket notationï¼‰**è®¿é—®å…¶ä¸­çš„å…ƒç´ ï¼Œå…ƒç´ é¡ºåºå°±æ˜¯ä¼ å…¥å‚æ•°çš„é¡ºåºï¼Œä»ä½ç½®0å¼€å§‹ã€‚è¦ç¡®å®šä¼ é€’å‚æ•°çš„ä¸ªæ•°ï¼Œå¯ä»¥è®¿é—®`arguments.length` å±æ€§
    
    ```jsx
    function aboutArguments() {
      console.log(arguments);
      console.log(arguments[0], arguments[2], arguments.length);
    }
    aboutArguments();
    // [Arguments] {}
    // undefined undefined 0
    aboutArguments("mangwu", 22);
    // [Arguments] { '0': 'mangwu', '1': 22 }
    // mangwu undefined 2
    aboutArguments("mangwu", 22, "male");
    // [Arguments] { '0': 'mangwu', '1': 22, '2': 'male' }
    // mangwu male 3
    ```
    
- é€šè¿‡ä¸Šè¿°çš„ä»£ç å¯ä»¥çŸ¥é“ï¼Œå³ä½¿**æ²¡æœ‰å‘½åå‚æ•°**ï¼ˆ**no named arguments**ï¼‰ï¼Œé€šè¿‡`arguments` ä»ç„¶å¯ä»¥è·å–å®é™…è°ƒç”¨ä¸­ä¼ é€’çš„å‚æ•°ï¼Œè¿™è¡¨æ˜ï¼ˆ**illustrates**ï¼‰ECMAScriptå‡½æ•°çš„**å‘½åå‚æ•°**åªæ˜¯**ä¸ºäº†æ–¹ä¾¿**æ‰å†™å‡ºæ¥çš„ï¼Œå¹¶**ä¸æ˜¯å¿…é¡»**å†™å‡ºæ¥çš„ã€‚è¿™ä¸€ç‚¹æ˜¯ä¸å…¶ä»–è¯­è¨€çš„ä¸åŒä¹‹å¤„ï¼šåœ¨ECMAScriptä¸­çš„å‘½åå‚æ•°**ä¸ä¼š**åˆ›å»ºè®©ä¹‹åçš„è°ƒç”¨å¿…é¡»åŒ¹é…çš„**å‡½æ•°ç­¾å**ï¼Œè¿™æ˜¯å› ä¸ºECMAScriptæ²¡æœ‰è®¾è®¡**éªŒè¯ï¼ˆvalidationï¼‰**å‘½åå‚æ•°çš„æœºåˆ¶è€Œæ˜¯ä½¿ç”¨`arguments` å¯¹è±¡è¿›è¡Œæ›¿ä»£

### 3.1.3.1 æ¨¡æ‹Ÿé‡è½½ï¼ˆoverloadingï¼‰

- æ²¡æœ‰å‡½æ•°ç­¾åè¿™ç§ç‰¹æ€§ä¼šä½¿å¾—å‡½æ•°çš„é‡è½½éš¾ä»¥å®ç°ï¼Œä½†æ˜¯é€šè¿‡`arguments` ç‰¹æ€§ï¼Œä»ç„¶å¯ä»¥æ¨¡æ‹Ÿå‡ºå‡½æ•°é‡è½½ï¼ˆoverloadingï¼‰
- é€šè¿‡`arguments` å¯¹è±¡çš„`length` å±æ€§æ£€æŸ¥ä¼ å…¥çš„å‚æ•°ä¸ªæ•°ï¼Œå®ç°ä¸åŒçš„åŠŸèƒ½
    
    ```jsx
    // ä½¿ç”¨argumentsæ¨¡æ‹Ÿå‡½æ•°é‡è½½ï¼ˆå…¶ä»–è¯­è¨€ä¾é å‡½æ•°ç­¾åå®ç°ï¼‰
    function increase() {
      if (arguments.length == 1) {
        return arguments[0] + 10;
      } else if (arguments.length == 2) {
        return arguments[0] + arguments[1];
      }
      throw new Error("è¯·ä¼ é€’1æˆ–2ä¸ªå‚æ•°");
    }
    
    console.log(increase(10)); // 20
    console.log(increase(30, 20)); // 50
    ```
    
    - `increase()` å‡½æ•°åªä¼ é€’ä¸€ä¸ªå‚æ•°æ—¶ï¼Œä¼šå°†å‚æ•°åŠ 10å¹¶è¿”å›ï¼Œåœ¨ä¼ é€’ä¸¤ä¸ªå‚æ•°æ—¶ï¼Œå°†å®ƒä»¬ç›¸åŠ å¹¶è¿”å›ï¼Œä¼ é€’å…¶ä»–ä¸ªæ•°å‚æ•°æ—¶æŠ›å‡ºå¼‚å¸¸
    - è™½ç„¶è¿™ä¸åƒçœŸæ­£å‡½æ•°é‡è½½é‚£ä¹ˆæ˜ç¡®ï¼ˆå‚æ•°çš„ç±»å‹å’Œé¡ºåºä¹Ÿè€ƒè™‘ï¼‰ï¼Œä½†è¿™å·²ç»è¶³ä»¥å¼¥è¡¥ECMAScriptåœ¨è¿™æ–¹é¢çš„ç¼ºå¤±

### 3.1.3.2 `arguments` ä¸å‘½åå‚æ•°ï¼ˆnamed argumentï¼‰

1. `arguments` å¯¹è±¡å¯ä»¥å’Œå‘½åå‚æ•°ä¸€èµ·ä½¿ç”¨
    
    ```jsx
    // argumentså¯¹è±¡å’Œå‘½åå‚æ•°å¯ä»¥ä¸€èµ·ä½¿ç”¨
    function increase(num1, num2) {
      if (arguments.length == 1) {
        return num1 + 10;
      } else if (arguments.length == 2) {
        return arguments[0] + num2;
      }
      throw new Error("è¯·ä¼ é€’1æˆ–2ä¸ªå‚æ•°");
    }
    console.log(increase(10));
    console.log(increase(30, 20));
    ```
    
    - åŒæ—¶ä½¿ç”¨å‘½åå‚æ•°å’Œ`arguments` å¯¹è±¡ï¼Œ`num1` å’Œ`arguments[0]` ä¿å­˜ç€ç›¸åŒçš„å€¼ï¼Œå› æ­¤ä½¿ç”¨è°éƒ½æ— æ‰€è°“
2. `arguments` å¯¹è±¡çš„å€¼**å§‹ç»ˆ**å’Œå¯¹åº”çš„å‘½åå‚æ•°**åŒæ­¥**ï¼ˆ**stay in sync with**ï¼‰ï¼Œè¿™å¥è¯ä¿è¯æ­£ç¡®çš„å‰ææ˜¯è°ƒç”¨å‡½æ•°æ—¶ï¼Œè¯¥å‘½åå‚æ•°è¢«ä¼ å€¼äº†
    
    ```jsx
    // argumentsçš„å€¼å§‹ç»ˆå’Œå¯¹åº”çš„å‘½åå‚æ•°ä¿æŒåŒæ­¥
    function syncNamedArguments(num) {
      arguments[0] = 5;
      console.log(num);
      num = 7;
      console.log(arguments[0]);
    }
    syncNamedArguments(1);
    // æ‰“å°
    5
    7
    ```
    
    - é€šè¿‡`arguments[0]` é‡å†™(rewrite)ç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼ï¼Œ`arguments` å¯¹è±¡çš„å€¼ä¼šè‡ªåŠ¨åŒæ­¥åˆ°å¯¹åº”çš„å‘½åå‚æ•°ï¼Œæ‰€ä»¥ä¿®æ”¹`arguments[0]` ä¹Ÿä¼šä¿®æ”¹`num` çš„å€¼ï¼Œæ‰€ä»¥æ‰“å°æ‰“å°`num` ä¼šå¾—åˆ°5
    - åŒç†é‡å†™`num` ä¹Ÿä¼šå½±å“`arguments[0]` çš„å€¼ï¼ŒäºŒè€…æ˜¯**åŒæ­¥**çš„
    - ä½†æ˜¯è¿™**å¹¶ä¸æ„å‘³ç€å®ƒä»¬è®¿é—®åŒä¸€ä¸ªå†…å­˜åœ°å€ï¼Œ**`arguments[0]` å’Œ`num` åœ¨å†…å­˜ä¸­è¿˜æ˜¯åˆ†å¼€çš„ï¼Œåªä¸è¿‡ä¼šä¿æŒåŒæ­¥è€Œå·²
        
        ğŸ§è¿™ä¸€ç‚¹å’Œä»£ç†å¾ˆåƒï¼Œä½†ä¸çŸ¥é“`arguments` çš„å…ƒç´ å’Œå‘½åå‚æ•°æ˜¯å¦æ˜¯ä»£ç†ï¼ˆproxyï¼‰å…³ç³»
        
    
    <aside>
    ğŸ’¡ **æ³¨æ„**ï¼šå¦‚æœæ²¡æœ‰ä¼ é€’å‚æ•°ï¼Œå³æ‰§è¡Œ`syncNamedArguments()` ,`arguments[0]` è®¾ç½®çš„å€¼ä¸ä¼šåæ˜ åˆ°`num` ä¸Šï¼Œ`num` è®¾ç½®çš„å€¼ä¹Ÿä¸ä¼šåæ˜ åˆ°`arguments[0]` ä¸Šï¼Œè¿™æ˜¯å› ä¸º`arguments` å¯¹è±¡çš„é•¿åº¦æ˜¯æ ¹æ®**ä¼ å…¥çš„å‚æ•°ä¸ªæ•°**ï¼Œè€Œéå®šä¹‰å‡½æ•°æ—¶ç»™å‡ºçš„å‘½åå‚æ•°ä¸ªæ•°ç¡®å®šçš„ï¼ˆå³**åŒæ­¥**åªä½œç”¨äº`arguments` å¯¹è±¡é•¿åº¦è§„å®šçš„å…ƒç´ ï¼Œåœ¨å‡½æ•°ä½“å†…éƒ¨æ”¹å˜`arguments`å¯¹è±¡çš„`length` å±æ€§ä¹Ÿä¸ä¼šä¿®æ”¹è§„å®šå¥½çš„åŒæ­¥è¡Œä¸ºï¼‰
    
    ```jsx
    function syncNamedArguments(num) {
      console.log(arguments.length);
      arguments.length = 1;
      console.log(arguments.length);
      arguments[0] = 5; // å¦‚æœæ²¡æœ‰ä¼ é€’å‚æ•°ï¼Œæ­¤ä¿®æ”¹ä¸ä¼šåŒæ­¥åˆ°å‘½åå‚æ•°ä¸­
      console.log(num);
    }
    syncNamedArguments();
    // æ‰“å°ç»“æœ
    0
    1
    undefined
    ```
    
    è¿˜éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œåœ¨**æ²¡æœ‰**å‚æ•°é»˜è®¤å€¼çš„æƒ…å†µä¸‹ï¼Œ**ä¼ é€’`undefined` çš„æƒ…å†µå±äºä¼ é€’äº†å‚æ•°**ï¼Œä¸”åŒæ­¥ä¾ç„¶æœ‰æ•ˆæœï¼›ä½†æ˜¯æœ‰å‚æ•°é»˜è®¤å€¼çš„æƒ…å†µå°±ä¼šæœ‰æ‰€ä¸åŒï¼Œå¯ä»¥æŸ¥çœ‹[5. é»˜è®¤å‚æ•°å€¼(Default Parameter Values)](5%20%E9%BB%98%E8%AE%A4%E5%8F%82%E6%95%B0%E5%80%BC(Default%20Parameter%20Values).md) ï¼›æ— è®ºä½¿ç”¨äº†é»˜è®¤å‚æ•°ä¸å¦ï¼Œä¼ é€’`undefined` éƒ½ä¼šå½±å“`arguments.length` çš„å€¼
    
    ```jsx
    syncNamedArguments(undefined);
    // æ‰“å°ç»“æœ
    1
    1
    5 // åŒæ­¥ç»“æœ
    ```
    
    </aside>
    
3. ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œ`arguments` å¯¹è±¡çš„è¡Œä¸ºä¼šæœ‰ä¸€äº›å˜åŒ–ï¼šé¦–å…ˆ`arguments` ä¸­çš„å…ƒç´ ä¸å†å’Œä¼ å…¥äº†å€¼çš„å‘½åå‚æ•°åŒæ­¥ï¼Œå…¶æ¬¡åœ¨å‡½æ•°ä½“ä¸­å°è¯•é‡å†™ï¼ˆoverwriteï¼‰`arguments` å¯¹ä¼šå¯¼è‡´è¯­æ³•é”™è¯¯ï¼ˆä»£ç ä¸ä¼šæ‰§è¡Œï¼‰
    
    ```jsx
    "use strict";
      function syncNamedArguments(num) {
        arguments[0] = 5;
        console.log(num);
        num = 7;
        console.log(arguments[0]);
      }
      // äºŒè€…ç›¸äº’ç‹¬ç«‹
      syncNamedArguments(1); // 1 5
      function overwriteArguments(num) {
        arguments = [1];
    		ä¸¥æ ¼æ¨¡å¼ä¸‹â€œargumentsâ€çš„ä½¿ç”¨æ— æ•ˆã€‚
      }
    ```
    

# 3.2 ç®­å¤´å‡½æ•°ä¸­çš„å‚æ•°

- å¦‚æœå‡½æ•°æ˜¯ä½¿ç”¨ç®­å¤´å‡½æ•°è¯­æ³•å®šä¹‰çš„ï¼Œé‚£ä¹ˆä¼ é€’ç»™å‡½æ•°çš„å‚æ•°ä¸èƒ½ä½¿ç”¨`arguments` å…³é”®å­—è¿›è¡Œè®¿é—®ï¼Œè€Œåªèƒ½é€šè¿‡å®šä¹‰çš„å‘½åå‚æ•°è®¿é—®ï¼Œå¦‚æœç®­å¤´å‡½æ•°å®šä¹‰æ‰€åœ¨çš„ä½œç”¨åŸŸæ²¡æœ‰`arguments` å¯¹è±¡ï¼Œä½¿ç”¨`arguments` ä¼šæŠ›å‡ºå¼•ç”¨å¼‚å¸¸çš„é”™è¯¯
    
    ```jsx
    function foo() {
      console.log(arguments);
    }
    foo(); // [Arguments] {}
    const a = () => console.log(arguments);
    a(); // Uncaught ReferenceError: arguments is not defined
    ```
    
    - ä¸Šè¿°æ˜¯åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹çš„æ‰“å°
    - åœ¨nodeç¯å¢ƒä¸‹ï¼ˆnodeæ‰§è¡Œå†™åœ¨æ–‡ä»¶ä¸­çš„ä»£ç ï¼‰ä¸ä¼šæŠ¥é”™ï¼Œå› ä¸ºç®­å¤´å‡½æ•°æ‰€åœ¨ä½œç”¨åŸŸæœ‰`arguments` å¯¹è±¡ï¼Œå°±æ˜¯`[exports, require, module, __filename, __dirname]` ,å…³äºnodeç¯å¢ƒçš„`this` å¯ä»¥æŸ¥çœ‹[var å˜é‡åœ¨nodeè·Ÿæµè§ˆå™¨ç¯å¢ƒä¸‹çš„å£°æ˜](../../JavaScript%E5%B0%8F%E8%AE%A1/this%E6%93%8D%E4%BD%9C%E7%AC%A6/var%20%E5%8F%98%E9%87%8F%E5%9C%A8node%E8%B7%9F%E6%B5%8F%E8%A7%88%E5%99%A8%E7%8E%AF%E5%A2%83%E4%B8%8B%E7%9A%84%E5%A3%B0%E6%98%8E.md)
- ä¸Šè¿°ä¾‹å­åœ¨nodeç¯å¢ƒä¸‹ä¸ä¼šæŠ¥é”™ï¼Œè¯´æ˜ç®­å¤´å‡½æ•°è™½ç„¶æ²¡æœ‰`arguments` å¯¹è±¡ï¼Œä½†æ˜¯å¯ä»¥åœ¨åŒ…è£…å‡½æ•°ä¸­ç»™ç®­å¤´å‡½æ•°å€Ÿç”¨`arguments` å¯¹è±¡ï¼Œå¦‚ä¸‹
    
    ```jsx
    function foo() {
    	let bar = () => console.log(arguments);
    	bar(); // [Arguments] {}
    }
    foo(5) // [Arguments] { '0': 5 }
    ```
    

<aside>
ğŸ’¡ æ³¨æ„ï¼šECMAScriptä¸­çš„æ‰€æœ‰å‚æ•°éƒ½æŒ‰å€¼ä¼ é€’ã€‚ä¸å¯èƒ½æŒ‰å¼•ç”¨ä¼ é€’å‚æ•°ï¼Œå¦‚æœæŠŠå¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œé‚£ä¹ˆä¼ é€’çš„å€¼å°±æ˜¯è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨

</aside>